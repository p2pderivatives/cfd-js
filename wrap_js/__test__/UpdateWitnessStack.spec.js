const {UpdateWitnessStack} = require('../cfdjs_raw_module');
const TestHelper = require('./TestHelper');

const testCase = [
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack stack index 0',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"33333333","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201043333333300000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack stack index 2',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620304111111110422222222043333333300000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":2,"hex":"44444444","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620304111111110422222222044444444400000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack hex empty',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262010000000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack type binary',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack type sign',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"11111111","type":"sign","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack type pubkey',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"0279BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","type":"pubkey","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f8179800000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack type redeemScript',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ac","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620123210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ac00000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack type sign derEncode',
    UpdateWitnessStack,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":0,"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"all"}}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb0100000000"}',
  ),
  TestHelper.createElementsTestCase(
    'UpdateWitnessStack witness stack to raw transaction',
    UpdateWitnessStack,
    ['{"tx":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e100001976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a1200000000000000000024730440220437d443d290dcbd21b9dfdc612ac6cc5134f5acca19aa3c90b870ec41480839d02205662e29994c06cbeba70640aa74c7a4aafa50dba52ff45117800a1680240af6b0104111111110000000000","isElements":true,"txin":{"txid":"c342eef6c062e6bf75fa49f2795faad83fb7b936573e2518c5ffa71d90603c0e","vout":1,"witnessStack":{"index":1,"hex":"02d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a09","type":"pubkey","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e100001976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a1200000000000000000024730440220437d443d290dcbd21b9dfdc612ac6cc5134f5acca19aa3c90b870ec41480839d02205662e29994c06cbeba70640aa74c7a4aafa50dba52ff45117800a1680240af6b012102d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a090000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'UpdateWitnessStack witness stack to Blinded raw transaction',
    UpdateWitnessStack,
    ['{"tx":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0301f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e100001976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000bbf9fd95e2dcc24f39de5ce5df9af9e77fbf89bc98d6aa30ecbaf6bd0e1a89926085f6d6db7546e9d5e97c04075d5bfefc3e58d54193bd45072e22f5f5814188ce302e1c567681f81f1b63f2b857c9bb90f60a2f395d346da9cf5e7a8a862e9092096016a00000000000002483045022100949831da48d2d0c39ffa13e2801ca995281484fa6d255043be440a5eee4be79602200b472a2e6cb2c8cd1b32e79b22c16e0965191b6b5dd43f9324e590a37ec83e2c010411111111000000000043010001924b8def6052a6b1f22853ed5dc88f06aa0cc4101c226b7a04e33ab7f0065f84abb33d53833f95083243444ba3bfead48415e52aed8ec98c3d045afbf369da4cfd450b40232868017280689d15679feecfb8e2ae91fcf4e58e392fda3db9b3353e0df68031928b425b39d75240bc67f0970e4218210820cad418e390d29228a52311febb8ee12d93ada9b84b9bc4aaa1a9319fffb47085829505ed4015c4410a86ecba02a56a9de6951d87903945ce1579a1021e2a55fce05d338f459b84c966480e37ff01b9c218abaa17217e96e28f79267a8e14ddcbd9e0582fa9660218ddac09df87e12442eab8e23942ab63ab197c058d740e69eb10090aa692f61708be75cb0444db862174eaf89eb25b6d791c6915a1ee316b8972ec606b43a4f8b8fdf5014797fdccb651f80a2d1be551cf74c5c82b5479ff7637d0424d9ee190e7cd1deb7aea15b1f3974a3588fbff0149e6588ecf999b79d6f5ad41762d683a5ba5535af6205fafc750aaa037f03d546589bb641b5b35f165768541328bdce275809f9347f7c186de30d7429f5815da8901087334faec8fc55da6df1c6d01c8b73b26047a973beb96df8936e46c70b9259bfaac52e4b32c72d1e391138bb5af2f65491cf6c7c3678e4915fa4d48ce3119a210fc0b9b49a7bc5706eb2bcafc505534a5a72f47a3067af39adb8d5472c5728053577ec0fbeab5a134b1ae2c262e2e1fe23cce4b8388564b0984f1cfac7ed2cdf51895427f4a8536a30ad12ff00a61bff7cace307add47d64bebc0759015066527c941f8a32f8babc7917eaf59b7ac4e36278e8ab896b0c8127ecbb832109a3bc2f519169025e3643c15bda9db4596a2e0fa24728c8ec0cadcfa070c49ae291367dd52d416a12ec73f87e0dcb018f511cca2864178c06bbae1dcfb78b22d4d344f91456a39cfbe135620730ff0ebf213e024a2e9d3ef4b9614a45aa923abc2e2b67c47961952280d97623f6931bb19b471fec6398a333c849d7be6745bc625064bdb18142930889b45374b62bf20b0e567dbf4ba10acb6bf6c382d175ec054694a097e61ca2f52952915b02d0ef1d20d6737aabb9ebeec8e3061dbc8224a250e85b6210ed5fc4fc92a6eb3ecc02fffdea730bd1607ab1540a53ec86690ff6f40871acbfc1ce6480e47f02c384e0d1094269e01e1959a7c9ea8791ffc82b53e137a7eff52b9a6892732429f27159e8f37890e4b220c6780abeeb2f80ce8fef031a34654613eae97e23c1f0d0c583246255dfb57a6e1d64e842446efdb31647f809007778bf4c39e5155cf58dba0726970fd66fa9af61fc70fb0ff42d4b5386c72084b74b820d9538bf8a395d1d527696776a36c9ab9d3ac30b136356585bd94ed4df92c18b25101494c231addf07808dbcac7a26f493b3a57a067dc17e6e3b3a0ccf115be480064e60ef540bbb5183b7ffddffaea74129224f5a2cd146bb6c6daa47fd5755b0057923b3ef5c913585d9cb03f69e7c27f7003a4c460c02eaabaa16c758e7351981ccb758367ce43989fdc37d79d7005442a174349077345f9ecd837e5dca4bb68e2e738f7229794aa6da521699e37097dc5d86f09ee11522aa7940c43469227c9bc241abaf88a57e91ec18b890a58454f458129c0e934e01e1f0a37fc084357f12aa11821b1afb759eb9578c140ce41874b6eed90f45131733d296cce9a6264d766e660b4fb977bd3ee606e71b2baef872395b68a74b4298646920635e35569978f96eefa700955e209556df8e86d235676657c2887886ba861f664ad8c0d85854a2e3ec2e02a7f3a5ca7d28772a73c646f6fdade0539c1b9cf00e0f23236b86d4d804b87fb5cae94ab92012582fe9ab12259a6d02497d738783df67b68c387f3634913162ce2db1f45972db2bb9f7c48a73bda7625e289bcb7a4d1218177346e875c5654b52684b5a58851b472d79e65204f9b69a8be5d72e84e26ce31d8535dfd5dd7f95bd39ad5b4a007d5265337d84421beab7ab4aeeaf4aeacc538e6bb244b524aaf6c34b065573fbfef1e9402eab1ee431217b8f05c1123677d4c9ee31f30d0222e3909b772a39700cacbf7972728bcc6e28f8eb26663e8792019b9c82b8c851cefa4674915dc3916afef981ef7e86551c79f614aaed77bfde740532669997c32a315b1caa8f280fd028643601e204e5b24e6cfee7819aec1520e1196451c96a34ed4cb7cab7b2d9cf0041f948a140077bb7896bd50947f6a632556c45dc00d1d71322a02e486a5a6cafc33ba1487d129fa46fb5ea749615348be228b4cfae065dd81bebe948c8920c211a848b40b01c0542a315e08a09e7b5ee6a7ebccb93f8dae509c8108156e1e85c3315f1bde7d5d89fec6d8abb825cc3550b8a458c3501c67d1eac6cd303b5499afc567f9deafdbcfeef7df335f847d6a1a6eff3e49ef857125ce2bb3918435b8a015ca9064c99d4d421cb1ac636831bfd489ec62dd86eeb0ece1d228dd8d456e758199b3e4d6dfa3dc74bf5d7d7197f766d608cfc388f7e501236583bf4efbd38ee410635676e97f06974a6f89452aed2d645efd1f98e8af7e52e199f873609b121ef58fc3060acaa013dc17ba29184b5be89830474da37419afaef4a82b6c0927bb2965ac01e6509c75dcc32dac5643e7ab12c982c99d02da2415509e68b2e87af8576f71ba648de92848dc745aebc2740e8379d05775048528001ef31baa225fe6711b27cacfdb9508acccbf274180cbfb8ad3c08f6e2f31c07943d2228db93b59cb70dabb4510e788de502c01027ce9255ecf877f412f7d0fb9715211521a4ce4ab14850c17acfe58c74faffe312d2e3f73a94c903307da7475683fb3bf812e58452690955dd7d106e763974e3ddf0c98159f2e20b31e31db07b7cd2a3f7da408108dd8868cdd8e2952390b17354e72fec32fcd095ee549ddc9edb6bb478257347a976c0e04ec462d00429c30cdf19af32cdeeaa3d4e5c0fba53d75a1908bfe6e8b245b8167bdbd1b752b8c8ac29eab0cb64ce2f35b78b7b7d85b83e5b50dd7dbb3b6ffa1fa7190abbf4d8b6f26ed23a8836a9b3b24ab67f4a65c1618a7222c5b4df7eb5f7d56ad80be8f45842a42790cf5373d13dec243b362b3978a8ac5242b138bfea549ec3c03df24fb3766aebc922d2c8eabeeda2bfd8d85196d52634340b730f2ee0be45a02fd0ab416de1df14e481203894f48736b60a324927461a8e5558338f5dc3d006150129691c9cf0c0be29462fe4cc5e852072077e7bc6f77163e3f669616ea974d3d434a78a34dce052699be1d7b53f3ed68ffb2733b0d1243039436d026ae5fe5d82bca4d3366784c4fa8f24dc643944972f11cd023bb8cb92b62873ebeaeaf72b983210167959e4a0c16344aea185c4fcb116a5b017da898a54e77cfdfb47e169ad1cf79a1b61a260c5f58ebb98813db910ffeec87ca0d98ba95d25f5e98651cb96c377233143323069750c8cf6756f79bbd8643e3c20a4824749aaf1486c6a934c330741f5e8364b1c255372b3d214944edd836c65a612de671cd22e13d9723c1fc738b6551ced7b7d5aeb867b47c38df51c7ae57a74c8bb43d31b518c7484f8fb44cfb73f28abed1d92310a10957c4190fe18302ca81c33e7cc52cfa1ea080c00c196cf9802cf74d9a4cb2f96ebb52dc6d7f79b5edf257211fe85f157e61fba42e48dfb595ffd58eb4f6cacbec90cc7b6ad5226839e54c3553540ecb47f135278d266820904eefedf442376e6486d018b7ba5708df6532968f91b022b018c66010182e27f9f789402ffccc89dadc1453b255b08aad7f30b81106efbb4df138e4b88b28d182c3d6393e6b939dca0133239f10339a96dc49800c93266a193ef43ca51e2d20307d14e1fd4d4426f538322c4962bb2c7da55b1ca946823ccb95620dfd765feb0e4f50d0df44b94f440f4255aa9595ce521ddb2c6dfa25356c0cbe7f7bb88f9dba1e66decb6a94edd9fa3e5fcc8cd774695c542ead12ffadd5c2df2e2904e9e208b975f52268d61e50103b30f178ca8ec742bb8641f696afe722724a9af5fa6b8a381bdf0d38920841d7c899946e0a7a59cdc07d2dfca53534fa9d380d3a7682b74fc5dbd36bd83426cd977db1fd884190a99936610b954c109e234e1de323f4cc9d2cc613cf2c857d90a75d8c6c57f55cc598dcb02546","isElements":true,"txin":{"txid":"c342eef6c062e6bf75fa49f2795faad83fb7b936573e2518c5ffa71d90603c0e","vout":1,"witnessStack":{"index":1,"hex":"02d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a09","type":"pubkey","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0301f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e100001976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000bbf9fd95e2dcc24f39de5ce5df9af9e77fbf89bc98d6aa30ecbaf6bd0e1a89926085f6d6db7546e9d5e97c04075d5bfefc3e58d54193bd45072e22f5f5814188ce302e1c567681f81f1b63f2b857c9bb90f60a2f395d346da9cf5e7a8a862e9092096016a00000000000002483045022100949831da48d2d0c39ffa13e2801ca995281484fa6d255043be440a5eee4be79602200b472a2e6cb2c8cd1b32e79b22c16e0965191b6b5dd43f9324e590a37ec83e2c012102d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a09000000000043010001924b8def6052a6b1f22853ed5dc88f06aa0cc4101c226b7a04e33ab7f0065f84abb33d53833f95083243444ba3bfead48415e52aed8ec98c3d045afbf369da4cfd450b40232868017280689d15679feecfb8e2ae91fcf4e58e392fda3db9b3353e0df68031928b425b39d75240bc67f0970e4218210820cad418e390d29228a52311febb8ee12d93ada9b84b9bc4aaa1a9319fffb47085829505ed4015c4410a86ecba02a56a9de6951d87903945ce1579a1021e2a55fce05d338f459b84c966480e37ff01b9c218abaa17217e96e28f79267a8e14ddcbd9e0582fa9660218ddac09df87e12442eab8e23942ab63ab197c058d740e69eb10090aa692f61708be75cb0444db862174eaf89eb25b6d791c6915a1ee316b8972ec606b43a4f8b8fdf5014797fdccb651f80a2d1be551cf74c5c82b5479ff7637d0424d9ee190e7cd1deb7aea15b1f3974a3588fbff0149e6588ecf999b79d6f5ad41762d683a5ba5535af6205fafc750aaa037f03d546589bb641b5b35f165768541328bdce275809f9347f7c186de30d7429f5815da8901087334faec8fc55da6df1c6d01c8b73b26047a973beb96df8936e46c70b9259bfaac52e4b32c72d1e391138bb5af2f65491cf6c7c3678e4915fa4d48ce3119a210fc0b9b49a7bc5706eb2bcafc505534a5a72f47a3067af39adb8d5472c5728053577ec0fbeab5a134b1ae2c262e2e1fe23cce4b8388564b0984f1cfac7ed2cdf51895427f4a8536a30ad12ff00a61bff7cace307add47d64bebc0759015066527c941f8a32f8babc7917eaf59b7ac4e36278e8ab896b0c8127ecbb832109a3bc2f519169025e3643c15bda9db4596a2e0fa24728c8ec0cadcfa070c49ae291367dd52d416a12ec73f87e0dcb018f511cca2864178c06bbae1dcfb78b22d4d344f91456a39cfbe135620730ff0ebf213e024a2e9d3ef4b9614a45aa923abc2e2b67c47961952280d97623f6931bb19b471fec6398a333c849d7be6745bc625064bdb18142930889b45374b62bf20b0e567dbf4ba10acb6bf6c382d175ec054694a097e61ca2f52952915b02d0ef1d20d6737aabb9ebeec8e3061dbc8224a250e85b6210ed5fc4fc92a6eb3ecc02fffdea730bd1607ab1540a53ec86690ff6f40871acbfc1ce6480e47f02c384e0d1094269e01e1959a7c9ea8791ffc82b53e137a7eff52b9a6892732429f27159e8f37890e4b220c6780abeeb2f80ce8fef031a34654613eae97e23c1f0d0c583246255dfb57a6e1d64e842446efdb31647f809007778bf4c39e5155cf58dba0726970fd66fa9af61fc70fb0ff42d4b5386c72084b74b820d9538bf8a395d1d527696776a36c9ab9d3ac30b136356585bd94ed4df92c18b25101494c231addf07808dbcac7a26f493b3a57a067dc17e6e3b3a0ccf115be480064e60ef540bbb5183b7ffddffaea74129224f5a2cd146bb6c6daa47fd5755b0057923b3ef5c913585d9cb03f69e7c27f7003a4c460c02eaabaa16c758e7351981ccb758367ce43989fdc37d79d7005442a174349077345f9ecd837e5dca4bb68e2e738f7229794aa6da521699e37097dc5d86f09ee11522aa7940c43469227c9bc241abaf88a57e91ec18b890a58454f458129c0e934e01e1f0a37fc084357f12aa11821b1afb759eb9578c140ce41874b6eed90f45131733d296cce9a6264d766e660b4fb977bd3ee606e71b2baef872395b68a74b4298646920635e35569978f96eefa700955e209556df8e86d235676657c2887886ba861f664ad8c0d85854a2e3ec2e02a7f3a5ca7d28772a73c646f6fdade0539c1b9cf00e0f23236b86d4d804b87fb5cae94ab92012582fe9ab12259a6d02497d738783df67b68c387f3634913162ce2db1f45972db2bb9f7c48a73bda7625e289bcb7a4d1218177346e875c5654b52684b5a58851b472d79e65204f9b69a8be5d72e84e26ce31d8535dfd5dd7f95bd39ad5b4a007d5265337d84421beab7ab4aeeaf4aeacc538e6bb244b524aaf6c34b065573fbfef1e9402eab1ee431217b8f05c1123677d4c9ee31f30d0222e3909b772a39700cacbf7972728bcc6e28f8eb26663e8792019b9c82b8c851cefa4674915dc3916afef981ef7e86551c79f614aaed77bfde740532669997c32a315b1caa8f280fd028643601e204e5b24e6cfee7819aec1520e1196451c96a34ed4cb7cab7b2d9cf0041f948a140077bb7896bd50947f6a632556c45dc00d1d71322a02e486a5a6cafc33ba1487d129fa46fb5ea749615348be228b4cfae065dd81bebe948c8920c211a848b40b01c0542a315e08a09e7b5ee6a7ebccb93f8dae509c8108156e1e85c3315f1bde7d5d89fec6d8abb825cc3550b8a458c3501c67d1eac6cd303b5499afc567f9deafdbcfeef7df335f847d6a1a6eff3e49ef857125ce2bb3918435b8a015ca9064c99d4d421cb1ac636831bfd489ec62dd86eeb0ece1d228dd8d456e758199b3e4d6dfa3dc74bf5d7d7197f766d608cfc388f7e501236583bf4efbd38ee410635676e97f06974a6f89452aed2d645efd1f98e8af7e52e199f873609b121ef58fc3060acaa013dc17ba29184b5be89830474da37419afaef4a82b6c0927bb2965ac01e6509c75dcc32dac5643e7ab12c982c99d02da2415509e68b2e87af8576f71ba648de92848dc745aebc2740e8379d05775048528001ef31baa225fe6711b27cacfdb9508acccbf274180cbfb8ad3c08f6e2f31c07943d2228db93b59cb70dabb4510e788de502c01027ce9255ecf877f412f7d0fb9715211521a4ce4ab14850c17acfe58c74faffe312d2e3f73a94c903307da7475683fb3bf812e58452690955dd7d106e763974e3ddf0c98159f2e20b31e31db07b7cd2a3f7da408108dd8868cdd8e2952390b17354e72fec32fcd095ee549ddc9edb6bb478257347a976c0e04ec462d00429c30cdf19af32cdeeaa3d4e5c0fba53d75a1908bfe6e8b245b8167bdbd1b752b8c8ac29eab0cb64ce2f35b78b7b7d85b83e5b50dd7dbb3b6ffa1fa7190abbf4d8b6f26ed23a8836a9b3b24ab67f4a65c1618a7222c5b4df7eb5f7d56ad80be8f45842a42790cf5373d13dec243b362b3978a8ac5242b138bfea549ec3c03df24fb3766aebc922d2c8eabeeda2bfd8d85196d52634340b730f2ee0be45a02fd0ab416de1df14e481203894f48736b60a324927461a8e5558338f5dc3d006150129691c9cf0c0be29462fe4cc5e852072077e7bc6f77163e3f669616ea974d3d434a78a34dce052699be1d7b53f3ed68ffb2733b0d1243039436d026ae5fe5d82bca4d3366784c4fa8f24dc643944972f11cd023bb8cb92b62873ebeaeaf72b983210167959e4a0c16344aea185c4fcb116a5b017da898a54e77cfdfb47e169ad1cf79a1b61a260c5f58ebb98813db910ffeec87ca0d98ba95d25f5e98651cb96c377233143323069750c8cf6756f79bbd8643e3c20a4824749aaf1486c6a934c330741f5e8364b1c255372b3d214944edd836c65a612de671cd22e13d9723c1fc738b6551ced7b7d5aeb867b47c38df51c7ae57a74c8bb43d31b518c7484f8fb44cfb73f28abed1d92310a10957c4190fe18302ca81c33e7cc52cfa1ea080c00c196cf9802cf74d9a4cb2f96ebb52dc6d7f79b5edf257211fe85f157e61fba42e48dfb595ffd58eb4f6cacbec90cc7b6ad5226839e54c3553540ecb47f135278d266820904eefedf442376e6486d018b7ba5708df6532968f91b022b018c66010182e27f9f789402ffccc89dadc1453b255b08aad7f30b81106efbb4df138e4b88b28d182c3d6393e6b939dca0133239f10339a96dc49800c93266a193ef43ca51e2d20307d14e1fd4d4426f538322c4962bb2c7da55b1ca946823ccb95620dfd765feb0e4f50d0df44b94f440f4255aa9595ce521ddb2c6dfa25356c0cbe7f7bb88f9dba1e66decb6a94edd9fa3e5fcc8cd774695c542ead12ffadd5c2df2e2904e9e208b975f52268d61e50103b30f178ca8ec742bb8641f696afe722724a9af5fa6b8a381bdf0d38920841d7c899946e0a7a59cdc07d2dfca53534fa9d380d3a7682b74fc5dbd36bd83426cd977db1fd884190a99936610b954c109e234e1de323f4cc9d2cc613cf2c857d90a75d8c6c57f55cc598dcb02546"}',
  ),
  TestHelper.createElementsTestCase(
    'UpdateWitnessStack witness stack to confidential raw transaction',
    UpdateWitnessStack,
    ['{"tx":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e10003c16a227c5c4d4b4682b71ee7cb809102cd8955b888757695898ea994bf74ee711976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000247304402206efa3f1e5b7e7fda581d44fb649f3d90fb5e600954d023552de7d4ce06c910950220383e69c76c1b624603ee1e1443222b6520f26b85d0fb58b9c304c0957ee30db80104111111110000000000","isElements":true,"txin":{"txid":"c342eef6c062e6bf75fa49f2795faad83fb7b936573e2518c5ffa71d90603c0e","vout":1,"witnessStack":{"index":1,"hex":"02d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a09","type":"pubkey","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005f5e10003c16a227c5c4d4b4682b71ee7cb809102cd8955b888757695898ea994bf74ee711976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000247304402206efa3f1e5b7e7fda581d44fb649f3d90fb5e600954d023552de7d4ce06c910950220383e69c76c1b624603ee1e1443222b6520f26b85d0fb58b9c304c0957ee30db8012102d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a090000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'UpdateWitnessStack witness stack to Blinded confidential raw transaction',
    UpdateWitnessStack,
    ['{"tx":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff020a2417737712c7d1653e03c86552ce380c3d61af9a3ba54dd1dbd51db408f9287b095fb3257e7d9b132004847c09648f4b9992d8ad29506b1be342cb3d9475425d83022ee13bb64db098575d3b2ba6e1f52b53d49b6d1b5ff0275e93d7433dbc6cbdc31976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000247304402205a378b3a2296c12b52c45802f77df0b70b4a5d814bd1071a70c06a6b601d8e9c022027d525ad88656b5737fcd84776cb36c934383c364bf27a3b06e0806edc5b94d70104111111110043010001c5d0b4525aec534f531c5d3e0ddfb8618e8db8785e89517672dbe6c67aa3fca1ba6ad434579109f2747bc2c2526f7ea91d2ca98d8796b6a41b318a2c15852e66fd4d0b602300000000000000011a8f01b99ebca96b5eb370a1652ea6c9edde98e8411b45a8c5db939ae0831a6e0a93ca848683e060c3d32429d0cf506745d79510aab9dfad6142c7a46f2be73c698207b495f4797e7def25345e5f7635646c259d4610a93e958bdfeb863251bb617c375c31adfa1f62bb670706c3dc03072eab6994c2a925c3872d4448d1a1b587cb04270d53498c12842b716b5e109b269ba6d8f7cabb55436fdeae08f3f5817ca7d266dbaef783e176dec8240aa6d05911f198d01d6e3329599a1bef686759d6d5e0237c20d7bb93c615ffac0990bab765bb2e55a747727d4e6e8b5d57033f334b256e9b7f8a3eb440581a8c96e01b4033652175d783d6d47bbd95e1c7fb609a0ced7e24fe7a8b9a05e488ca891deec86956d2e6eb40826c32fab60526ffaa49bcaf0376d47492c58e3045a0ab9f498eee161c0e65fca7a5b7e6b11f0e216290677404d916b6f25b54d5cc4dff732c81ec493c3dddb671ad09677c114ddbec8b7f4b8bc62f2fe84379665098cd768dad953eb24c060226748d56984e180022e7bbe156fbb164b5f7a058d94db31d216b62f3900b7a33ca873b827af2d1f7ba6e13ae125173310cb8b1f898dc30bdfa2b69dbd3a60b11e2a359d75489c5a748e2cc97538752a6ab8a3829c4db11682ae594f30c4c86f4372c8a5a7e3ec14097b51c262873582f9524548b07ac9bb834c81988fb25e12b42b37aa412c1e9296ac8a61aa5ae18e8cacfc1cc4106b54475f7efef810e4a598e8705769b38bf3f6b0cb3a0285be99bd6484bc4cc536fcb43a8562164433df7460e914d4cbf597041f4be8b3721fd5dfec12c698f80a51b71addf1ea41c175c482c5a44e1ed16371eb55fb0ba4a1cc051da5d767cc364186315d3e684af7bab5bbcca3841e479ff5c6106e7f36e4d0988251926314aa6c8285d1b3011edde92154dc7eab44939bb888e1af3dc3b676d86643c18dc807de4e9e124174e815a47522a69b283274d1d486ff506ec63ce1fee76b934d37317e194c9b535db9267508c33bca77df266362dfa2872ac962f3fc0faee552f4ca5e76feda01b2705bddf820f030d86a9440f32c22dda9b5679e6d810c59d9a6e33fc4296762a6261fb2aab5ca5fe8528d906c77ad8c4e5237b4792c26f4d3ef58eaf9ce893aabbf8194f09a13023721b6de76523d5033e24033f558df8619725745fb6a7683ce47e5bb86756a41997c4e4fbf91c104fd3ade25b9f2eca3cdf69a34cd5f4e93c4f4771882d0fe2b534991187014fd908491ea83dd090d0207794997b45ea15c3ba02e40756917277ea330e339f1986fcbfc413d7b091c142d8d92932ac907aa633686ef3b13959f2da2c7ac1c354da6bf75831e5a3c495ce5202acb836a80cd27302f1922fc04c8701fedfa7f209c61bf7becf92c84ee687f1c2ecf4defbf07884e025fbf5e54237c142b8f1289534e98442018ae87935d43e0bf243b813d3e85b41464aefe07b47838ed40ca7426ba9c54415d2648ab0c90844a86a8e2d79da7cc4c2abd2e3dc25c173d8e4e468774350cd36a2ba2203e1cc29de321acd5b4e02e6999edd35949745198b56f73b015e9bd13cba0f5fcf31d25d52cddee7d5c9d3ce0ddfaaebeb70441afa6feb28df1ae946ba684e2b5de7411eea85cf9d9206b0462025aab5e962d4b5e5295fc8d9bc4e2c605cc7a3aa188e070be6959b43feba3ffee452a107b08d6d7809f89e75af1f1b8f4f4c9b5c625a84544ddd8b5998b8c5e4ad21ce7dc1489da18db8c3fa332184cc129280c996f620bf8594300bfa600648bde7f85fe97fc09e7543b078ccf914aae2e7eeaa0d1fe28b606fe94da275ad5623dac72135d4cbf2101b5fbeb702b8e861a14b862eee79394dcb5dfa2723fc0d53f35efb7af641453bbc8941262b2009d5ab739794109bfd87d44354fad35cb0962d8326a58013d472b25db9e26ede0488bbad8315a01d5affbe4f9ec399badb88357c748c51bbfe8302c117a278316a5bc7c265b1e143c82ec244a8f33068e8bf16d165026d95d5643b4260f9ed232dd72e1d87240ef06cc1b7bece931b405d0632b6969856135d6c89e771e3f08076ca327eb40d76270ed1d443f7ea1f448755ba43cb33ab3a0a773af89460f5577f78501e2cadb34902527d2ffad070deb95bcb0e7aaa805afeee527e9ee509e8b9f1fcb71b7b11f26badd4fff95f2593d60bef00758c34d46f872e7bc20e6251cc6ce124a286e6edc18af99f639699e247f37e7d84bdaf8e2f6fb9f84cf1fbb45b34fd8690019d565cd60230ab99096ed6f6dfe29ec68c66d97443d06ecb264781b957bd00810ebd31d5b2a6b4f908a87d5eaa6f257e4e30f712fc43385f6a446601ace32ea6d9d6c8ee7d0ac304a337593ff9c5021dcbd1aa03210a6a5bd4b146366f59b9957f06f50338863c5af3469770f25e67c1188701163baec15b98b486e5b169f8aa100737e538e5b32b5a59fbf76c06a0767cef297b968d66973df7e64679e454516d0265ffa789f45bf6036cb292bdaa078a5d4262153753b3f759ad9ff0d28b130d33b301946b7c74616870ec41052db81f59cdba819968be87a3bd9255e38755abd07bf9887f3520b60faad5f63f4c20d4e580d6c28a969c7c5283967354acb0a74a42af0ac71cdbf1ce9312bbfd313df2ebc0fcda50b4bbba15eaa6b2531e0154e59ce5419f82d592dec216ba9039f6655f6f219ce32b9d5adee929429945a1fab7e8ba9ea0359d34d2e837ab0afae97591c2fb2cbfaa44cd780b39e0c47dbe6e6ae6176daaffdd1f65689961ed05f184b9a715b770928206bb988a5e4ef831a479e94ba34acd5b9f633efa648149fc3760722a7ba83749da608c0fdb23d3b59763910c29bf95ca9220963de19f9a3870d5f7fd68e98fa3e234d3d13de43494f3ea554350eb337c2295f84afafe44efb5e8a41cb84cbc32f0e6fc2ac5ccabc0f9886606db6a5c574ee1c0a291fc953fdafd81467ae5b4ece0e68678ee2e78f6d71bc1bfe0d6bd5b63c29b61d01ca5dbf86275a6362e4c9cff5f75de74d766d014255d16a809660ab9714da17009046dde8d33e541c77c92f6bac4ce25cffe213b9851c93bcd7d6d833e7da6372be4bf6611fcadee9ee1153bd91da1c22de21b7552ab3cca974b7f513dedf0a2fa69bde7fef3e92b32f3282f96642e2e585793c0755ef6caf6c4572cc99d11f7207329efa2a68e602977bfd18f533b46f43d07ab9e437f65f90fe28b79d797e6da83298b218c7fe48fe831e43eb95f0aff4190b63ef800310fc8af1ed07f13604dec8d69e74f20d4f089581c5feeab7735e46067ab63221e3f5989539cd82305b77caec15f48a441e9fbf5183ee92a653ccaf87bf1337f3e85336612ef8e2b477770fc76eaf12dfe1cdbc416386be8b015c7f533b8e4930e15d1d43061b0080365c089786c48c09a047ff0aff7010ff9f39e3f2ebbb4805b10161ee20abb92a0b3986c6ac1ea54503fd28d77cf2dbdb1c50d8254a4b96b29281ccf1a1297a5f9aa5ec122e363346b23ec70bb10f2fc1d20e6bc3734802a21cc1c8d29f3dfa86a29b9d7aa5cceadef396f784da5167da68092ba4e173492224af7d9c037a04ea4b436f00048d6690e515d4e539ad5a08eb82a426d22b744d5d0e43b7df24e8b7dd2a5b04155cbfb8cf6398d9d8dc69dd8ddb712e548865e9f6a7acedf90afe2c1f9f55a48019677fdd54151891d9d85346613fd131b082d63367f3a06c4f5a6dbfebabb7f98a0bc8907aa0bde2e6a5f8d175071d738dcc4c958a0027e53661e344d971368473aba31dc6dd6a419d330658e579c2cf86252d20674e1e72c34ef5cafe4c8502c0ccf9ca782a1cf6470447d18b3b05e43b3769571ace523b4bb0f9bce857048a527f628611b9ce966d7bc2e3dc7067530fd86ee69878405a39afa448856c320b242a2562196682eb0b809560017a880a8dc2a9a5b8eace697873e9b5b761cf0e1fa3fbe0a67f7ac2ded1eb04d811fda2027ed410238e2a93c36e2b60e1436930e09189208f01d51c4cbfff90bb9b03a112948d56c6781202de42b731763b5631073289a4fe80d0000","isElements":true,"txin":{"txid":"c342eef6c062e6bf75fa49f2795faad83fb7b936573e2518c5ffa71d90603c0e","vout":1,"witnessStack":{"index":1,"hex":"02d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a09","type":"pubkey","derEncode":false,"sighashType":"all"}}}'],
    '{"hex":"0200000001010e3c60901da7ffc518253e5736b9b73fd8aa5f79f249fa75bfe662c0f6ee42c301000000171600140c2eade9f3c984d0b2cedc79075a5793b0f5ce05ffffffff020a2417737712c7d1653e03c86552ce380c3d61af9a3ba54dd1dbd51db408f9287b095fb3257e7d9b132004847c09648f4b9992d8ad29506b1be342cb3d9475425d83022ee13bb64db098575d3b2ba6e1f52b53d49b6d1b5ff0275e93d7433dbc6cbdc31976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000247304402205a378b3a2296c12b52c45802f77df0b70b4a5d814bd1071a70c06a6b601d8e9c022027d525ad88656b5737fcd84776cb36c934383c364bf27a3b06e0806edc5b94d7012102d8595abf5033d37a8a04947a537e8b28e2cb863e1ccd742012334c47e2c87a090043010001c5d0b4525aec534f531c5d3e0ddfb8618e8db8785e89517672dbe6c67aa3fca1ba6ad434579109f2747bc2c2526f7ea91d2ca98d8796b6a41b318a2c15852e66fd4d0b602300000000000000011a8f01b99ebca96b5eb370a1652ea6c9edde98e8411b45a8c5db939ae0831a6e0a93ca848683e060c3d32429d0cf506745d79510aab9dfad6142c7a46f2be73c698207b495f4797e7def25345e5f7635646c259d4610a93e958bdfeb863251bb617c375c31adfa1f62bb670706c3dc03072eab6994c2a925c3872d4448d1a1b587cb04270d53498c12842b716b5e109b269ba6d8f7cabb55436fdeae08f3f5817ca7d266dbaef783e176dec8240aa6d05911f198d01d6e3329599a1bef686759d6d5e0237c20d7bb93c615ffac0990bab765bb2e55a747727d4e6e8b5d57033f334b256e9b7f8a3eb440581a8c96e01b4033652175d783d6d47bbd95e1c7fb609a0ced7e24fe7a8b9a05e488ca891deec86956d2e6eb40826c32fab60526ffaa49bcaf0376d47492c58e3045a0ab9f498eee161c0e65fca7a5b7e6b11f0e216290677404d916b6f25b54d5cc4dff732c81ec493c3dddb671ad09677c114ddbec8b7f4b8bc62f2fe84379665098cd768dad953eb24c060226748d56984e180022e7bbe156fbb164b5f7a058d94db31d216b62f3900b7a33ca873b827af2d1f7ba6e13ae125173310cb8b1f898dc30bdfa2b69dbd3a60b11e2a359d75489c5a748e2cc97538752a6ab8a3829c4db11682ae594f30c4c86f4372c8a5a7e3ec14097b51c262873582f9524548b07ac9bb834c81988fb25e12b42b37aa412c1e9296ac8a61aa5ae18e8cacfc1cc4106b54475f7efef810e4a598e8705769b38bf3f6b0cb3a0285be99bd6484bc4cc536fcb43a8562164433df7460e914d4cbf597041f4be8b3721fd5dfec12c698f80a51b71addf1ea41c175c482c5a44e1ed16371eb55fb0ba4a1cc051da5d767cc364186315d3e684af7bab5bbcca3841e479ff5c6106e7f36e4d0988251926314aa6c8285d1b3011edde92154dc7eab44939bb888e1af3dc3b676d86643c18dc807de4e9e124174e815a47522a69b283274d1d486ff506ec63ce1fee76b934d37317e194c9b535db9267508c33bca77df266362dfa2872ac962f3fc0faee552f4ca5e76feda01b2705bddf820f030d86a9440f32c22dda9b5679e6d810c59d9a6e33fc4296762a6261fb2aab5ca5fe8528d906c77ad8c4e5237b4792c26f4d3ef58eaf9ce893aabbf8194f09a13023721b6de76523d5033e24033f558df8619725745fb6a7683ce47e5bb86756a41997c4e4fbf91c104fd3ade25b9f2eca3cdf69a34cd5f4e93c4f4771882d0fe2b534991187014fd908491ea83dd090d0207794997b45ea15c3ba02e40756917277ea330e339f1986fcbfc413d7b091c142d8d92932ac907aa633686ef3b13959f2da2c7ac1c354da6bf75831e5a3c495ce5202acb836a80cd27302f1922fc04c8701fedfa7f209c61bf7becf92c84ee687f1c2ecf4defbf07884e025fbf5e54237c142b8f1289534e98442018ae87935d43e0bf243b813d3e85b41464aefe07b47838ed40ca7426ba9c54415d2648ab0c90844a86a8e2d79da7cc4c2abd2e3dc25c173d8e4e468774350cd36a2ba2203e1cc29de321acd5b4e02e6999edd35949745198b56f73b015e9bd13cba0f5fcf31d25d52cddee7d5c9d3ce0ddfaaebeb70441afa6feb28df1ae946ba684e2b5de7411eea85cf9d9206b0462025aab5e962d4b5e5295fc8d9bc4e2c605cc7a3aa188e070be6959b43feba3ffee452a107b08d6d7809f89e75af1f1b8f4f4c9b5c625a84544ddd8b5998b8c5e4ad21ce7dc1489da18db8c3fa332184cc129280c996f620bf8594300bfa600648bde7f85fe97fc09e7543b078ccf914aae2e7eeaa0d1fe28b606fe94da275ad5623dac72135d4cbf2101b5fbeb702b8e861a14b862eee79394dcb5dfa2723fc0d53f35efb7af641453bbc8941262b2009d5ab739794109bfd87d44354fad35cb0962d8326a58013d472b25db9e26ede0488bbad8315a01d5affbe4f9ec399badb88357c748c51bbfe8302c117a278316a5bc7c265b1e143c82ec244a8f33068e8bf16d165026d95d5643b4260f9ed232dd72e1d87240ef06cc1b7bece931b405d0632b6969856135d6c89e771e3f08076ca327eb40d76270ed1d443f7ea1f448755ba43cb33ab3a0a773af89460f5577f78501e2cadb34902527d2ffad070deb95bcb0e7aaa805afeee527e9ee509e8b9f1fcb71b7b11f26badd4fff95f2593d60bef00758c34d46f872e7bc20e6251cc6ce124a286e6edc18af99f639699e247f37e7d84bdaf8e2f6fb9f84cf1fbb45b34fd8690019d565cd60230ab99096ed6f6dfe29ec68c66d97443d06ecb264781b957bd00810ebd31d5b2a6b4f908a87d5eaa6f257e4e30f712fc43385f6a446601ace32ea6d9d6c8ee7d0ac304a337593ff9c5021dcbd1aa03210a6a5bd4b146366f59b9957f06f50338863c5af3469770f25e67c1188701163baec15b98b486e5b169f8aa100737e538e5b32b5a59fbf76c06a0767cef297b968d66973df7e64679e454516d0265ffa789f45bf6036cb292bdaa078a5d4262153753b3f759ad9ff0d28b130d33b301946b7c74616870ec41052db81f59cdba819968be87a3bd9255e38755abd07bf9887f3520b60faad5f63f4c20d4e580d6c28a969c7c5283967354acb0a74a42af0ac71cdbf1ce9312bbfd313df2ebc0fcda50b4bbba15eaa6b2531e0154e59ce5419f82d592dec216ba9039f6655f6f219ce32b9d5adee929429945a1fab7e8ba9ea0359d34d2e837ab0afae97591c2fb2cbfaa44cd780b39e0c47dbe6e6ae6176daaffdd1f65689961ed05f184b9a715b770928206bb988a5e4ef831a479e94ba34acd5b9f633efa648149fc3760722a7ba83749da608c0fdb23d3b59763910c29bf95ca9220963de19f9a3870d5f7fd68e98fa3e234d3d13de43494f3ea554350eb337c2295f84afafe44efb5e8a41cb84cbc32f0e6fc2ac5ccabc0f9886606db6a5c574ee1c0a291fc953fdafd81467ae5b4ece0e68678ee2e78f6d71bc1bfe0d6bd5b63c29b61d01ca5dbf86275a6362e4c9cff5f75de74d766d014255d16a809660ab9714da17009046dde8d33e541c77c92f6bac4ce25cffe213b9851c93bcd7d6d833e7da6372be4bf6611fcadee9ee1153bd91da1c22de21b7552ab3cca974b7f513dedf0a2fa69bde7fef3e92b32f3282f96642e2e585793c0755ef6caf6c4572cc99d11f7207329efa2a68e602977bfd18f533b46f43d07ab9e437f65f90fe28b79d797e6da83298b218c7fe48fe831e43eb95f0aff4190b63ef800310fc8af1ed07f13604dec8d69e74f20d4f089581c5feeab7735e46067ab63221e3f5989539cd82305b77caec15f48a441e9fbf5183ee92a653ccaf87bf1337f3e85336612ef8e2b477770fc76eaf12dfe1cdbc416386be8b015c7f533b8e4930e15d1d43061b0080365c089786c48c09a047ff0aff7010ff9f39e3f2ebbb4805b10161ee20abb92a0b3986c6ac1ea54503fd28d77cf2dbdb1c50d8254a4b96b29281ccf1a1297a5f9aa5ec122e363346b23ec70bb10f2fc1d20e6bc3734802a21cc1c8d29f3dfa86a29b9d7aa5cceadef396f784da5167da68092ba4e173492224af7d9c037a04ea4b436f00048d6690e515d4e539ad5a08eb82a426d22b744d5d0e43b7df24e8b7dd2a5b04155cbfb8cf6398d9d8dc69dd8ddb712e548865e9f6a7acedf90afe2c1f9f55a48019677fdd54151891d9d85346613fd131b082d63367f3a06c4f5a6dbfebabb7f98a0bc8907aa0bde2e6a5f8d175071d738dcc4c958a0027e53661e344d971368473aba31dc6dd6a419d330658e579c2cf86252d20674e1e72c34ef5cafe4c8502c0ccf9ca782a1cf6470447d18b3b05e43b3769571ace523b4bb0f9bce857048a527f628611b9ce966d7bc2e3dc7067530fd86ee69878405a39afa448856c320b242a2562196682eb0b809560017a880a8dc2a9a5b8eace697873e9b5b761cf0e1fa3fbe0a67f7ac2ded1eb04d811fda2027ed410238e2a93c36e2b60e1436930e09189208f01d51c4cbfff90bb9b03a112948d56c6781202de42b731763b5631073289a4fe80d0000"}',
  ),
];

const errorCase = [
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack empty hex string',
    UpdateWitnessStack,
    ['{"tx":"","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty data."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack invalid hex string(3 chars)',
    UpdateWitnessStack,
    ['{"tx":"000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack empty txid string',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"","vout":0,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack invalid txid string (20 chars)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d16730","vout":0,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack txid not found',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4d","vout":0,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack append signature to invalid txin(vout: -1)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":-1,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Json value convert error. Value out of range."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack append signature to invalid txin(vout: 1)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":1,"witnessStack":{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack invalid witness stack index (-1)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":-1,"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Json value convert error. Value out of range."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack witness stack index not found (10)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"index":10,"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":2,"type":"illegal_state","message":"witness stack set error."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack invalid witness stack hex (3 chars)',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"hex":"111","type":"binary","derEncode":false,"sighashType":"all"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack empty witness stack sighashType',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":""}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'UpdateWitnessStack invalid witness stack sighashType',
    UpdateWitnessStack,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"witnessStack":{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"abcde"}}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
];

TestHelper.doTest('UpdateWitnessStack', testCase);
TestHelper.doTest('UpdateWitnessStack ErrorCase', errorCase);

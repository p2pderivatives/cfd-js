const {AddSign} = require('../cfdjs_raw_module');
const TestHelper = require('./TestHelper');

const testCase = [
  TestHelper.createBitcoinTestCase(
    'AddSign stack empty to 1',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign stack 1 to 2 (ClearStack is true)',
    AddSign,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"}],"clearStack":true}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201042222222200000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign stack 1 to 2 (ClearStack is false)',
    AddSign,
    ['{"tx":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"}],"clearStack":false}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262020411111111042222222200000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign stack empty to 3',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"},{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"},{"hex":"33333333","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620304111111110422222222043333333300000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack hex empty',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262010000000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack type binary',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack type sign',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"sign","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201041111111100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack type pubkey',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"0279BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","type":"pubkey","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f8179800000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack type redeemScript',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ac","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620123210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ac00000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack type sign derEncode',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"all"}]}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326201473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb0100000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign legacy p2pkh',
    AddSign,
    ['{"tx":"01000000019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b580000000000ffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac00000000","txin":{"txid":"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c","vout":0,"isWitness":false,"signParam":[{"hex":"773420c0ded41a55b1f1205cfb632f08f3f911a53e7338a0dac73ec6cbe3ca471907434d046185abedc5afddc2761a642bccc70af6d22b46394f1d04a8b24226","type":"sign","derEncode":true,"sighashType":"all"}, {"hex":"031777701648fa4dd93c74edd9d58cfcc7bdc2fa30a2f6fa908b6fd70c92833cfb","type":"pubkey"}]}}'],
    '{"hex":"01000000019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b58000000006a4730440220773420c0ded41a55b1f1205cfb632f08f3f911a53e7338a0dac73ec6cbe3ca4702201907434d046185abedc5afddc2761a642bccc70af6d22b46394f1d04a8b242260121031777701648fa4dd93c74edd9d58cfcc7bdc2fa30a2f6fa908b6fd70c92833cfbffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac00000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign legacy p2sh',
    AddSign,
    ['{"tx":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a80000000000ffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000","txin":{"txid":"a8e4694cb21eec489a84e345f381739f99983bd175aa1f7b8ae1953b5f0007e0","vout":0,"isWitness":false,"signParam":[{"hex":"54b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c6717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb26","type":"sign","derEncode":true,"sighashType":"all"}, {"hex":"2102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906ac","type":"redeem_script"}]}}'],
    '{"hex":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a8000000006c473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601232102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906acffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign auto',
    AddSign,
    ['{"tx":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a80000000000ffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000","txin":{"txid":"a8e4694cb21eec489a84e345f381739f99983bd175aa1f7b8ae1953b5f0007e0","vout":0,"isWitness":false,"signParam":[{"hex":"54b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c6717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb26","type":"auto","derEncode":true,"sighashType":"all"}, {"hex":"2102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906ac","type":"auto"}]}}'],
    '{"hex":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a8000000006c473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601232102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906acffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign OP_CODE',
    AddSign,
    ['{"tx":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a80000000000ffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000","txin":{"txid":"a8e4694cb21eec489a84e345f381739f99983bd175aa1f7b8ae1953b5f0007e0","vout":0,"isWitness":false,"signParam":[{"hex":"OP_TRUE","type":"op_code"},{"hex":"OP_16","type":"op_code"},{"hex":"OP_1NEGATE","type":"op_code"}], "clearStack":false}}'],
    '{\"hex\":\"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a8000000000351604fffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000\"}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign multisig auto',
    AddSign,
    ['{"tx":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a80000000000ffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000","txin":{"txid":"a8e4694cb21eec489a84e345f381739f99983bd175aa1f7b8ae1953b5f0007e0","vout":0,"isWitness":false,"signParam":[{"hex":"OP_0","type":"auto"},{"hex":"3044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601","type":"auto"},{"hex":"3044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601","type":"auto"},{"hex":"522102e9662b666479ed7117aa76fb96f322a84408d0882707b301c7450098d439680d2103c0230a322f70675bef21097242ac70647798826588e47eca14e5715cef77008c52ae","type":"auto"}], "clearStack":false}}'],
    '{"hex":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a800000000d900473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb260147522102e9662b666479ed7117aa76fb96f322a84408d0882707b301c7450098d439680d2103c0230a322f70675bef21097242ac70647798826588e47eca14e5715cef77008c52aeffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000"}',
  ),
];

const errorCase = [
  TestHelper.createBitcoinTestCase(
    'AddSign empty hex string',
    AddSign,
    ['{"tx":"","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty data."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign invalid hex string(3 chars)',
    AddSign,
    ['{"tx":"000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign empty txid string',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign invalid txid string (20 chars)',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d16730","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign txid not found',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4d","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign append signature to invalid txin(vout: -1)',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":-1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Json value convert error. Value out of range."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign append signature to invalid txin(vout: 1)',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign witness stack empty',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[]}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"witness_datas empty."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign invalid witness stack hex (3 chars)',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign empty witness stack sighashType',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":""}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign invalid witness stack sighashType',
    AddSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParam":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"abcde"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
  TestHelper.createBitcoinTestCase(
    'AddSign OP_CODE not push operator',
    AddSign,
    ['{"tx":"0100000001e007005f3b95e18a7b1faa75d13b98999f7381f345e3849a48ec1eb24c69e4a80000000000ffffffff0130ea052a010000001976a9140c989a8914b27e3a8402990000c05d081f3376c588ac00000000","txin":{"txid":"a8e4694cb21eec489a84e345f381739f99983bd175aa1f7b8ae1953b5f0007e0","vout":0,"isWitness":false,"signParam":[{"hex":"OP_TRUE","type":"op_code"},{"hex":"OP_16","type":"op_code"},{"hex":"OP_CHECKMULTISIG","type":"op_code"}], "clearStack":false}}'],
    '{\"error\":{\"code\":1,\"type\":\"illegal_argument\",\"message\":\"unlocking script error. The script needs to be push operator only.\"}}',
  ),
];

const testCaseElements = [
  TestHelper.createElementsTestCase(
    'AddSign stack empty to 1',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b4000000000000000000104111111110000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign stack 1 to 2 (ClearStack is true)',
    AddSign,
    ['{"tx":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b4000000000000000000104111111110000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"}],"clearStack":true}'],
    '{"hex":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b4000000000000000000104222222220000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign stack 1 to 2 (ClearStack is false)',
    AddSign,
    ['{"tx":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b4000000000000000000104111111110000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"}],"clearStack":false}'],
    '{"hex":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000000002041111111104222222220000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign stack empty to 3',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"},{"hex":"22222222","type":"binary","derEncode":false,"sighashType":"all"},{"hex":"33333333","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b400000000000000000030411111111042222222204333333330000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign witness stack hex empty',
    AddSign,
    ['{"tx":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff020ae145e8632536e224757bd032e072746d30abf69b354988400edf39983f008793084922fb4232da7c9d12c88dcbf329175771bf4333bbbea23343e86023490253b4037400a34d389ced89874ab4fcd56b4a6b5d224c6fbe7e35598a27819b2c3c7a211976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000000000004301000173423ed95c29c059e93ee3becbd2a5e92cbf9e4ff5e54295c6602b7e997276141c367723a203679ef194e21280e652387926a586a3561ed9d3ec47b88eb18bb6fdcd0d602b0000000000000001373b0d3a0ae0e9b18d3b990f3050cd390391943ec0858a96a05f39900b2b46e60e7d9af5ebefecf46ada21a5cddb6d60b7df85d6896a4dfc2a3c0c452b7e1024805603253f2a1768c59d3dfce39234bec188a9b3f795f0dde4dafdc477942ee36698556e39eecf5c327cece7e05b912d254fc0cbd83dfb3f41fdc8b8ce43221cb06a82be5e05891517a78c3b9ca0c55266a9111603dc0ef78e19761448403cf4b104b2a4acd0bdecb45c3b35c8eaa024a5db7891c1a8d3282c3f7406e770ac9a6fe5b7e7a6abb1446badbf1feb0a1ab707d6ddee05eaf62ac45405ee45be142027cce0ca05d92368d30a0a9423da5d71edb75c221763c8a6703e47d1a958fe7447f9c8d8aadf1c29b45d3cc32d4ff40cca9c734347e0c5549f98d8b461141db694b6bda0f71d6891561ef4e000917ea0ab571d13ed81ede908b34dccb7e1c9f51e151d912bfeeaddc848066bf04c8eb1751ec15bbed66f8e787db2a152161f79f9a459870c713684c3f2c9537fbf7c0f932e47eb478fb78e9cb98a6a0d64a08b61070d63e244eacb01e12d2e6cc03a312589130294e4dad665051182367b4fb468f135ae89a77670365317d0e72a992dccbeca32519f755686ca218572e9a95ce129c09dd5209202cf4a234a947738efcfe4fa1009e02267ecfdc434a3bbda321664c63420607f2493d562df2ad42d3eb5dfcf5cd59820b27f1f87d4cb887ba833c73ecccf90d61d13f67484c0169cf27bca2ac6ce4898b07a035508382b932395eaaaff852be4faabee9023679a2652892d2e43e4f77bed08a25a5b3576a318c2e017c1a4f05597760b0ae7b484a0fd32777ebeeaa4ee94f8475cbde545469f254d21b36dbd590fc6daf68b58f694cfd42054e8c03fc4f72631a977ed5a6097516c56ebd6bde09b4db18a8577e3d948660b0ad2f3f86c75e97d6845ee98874dd88a934bf5f7b43fc029f0cf04a2e91caa881d87875fdd32c9f9097f29e9e72d08efad9c2399eb58d6df098cf004845360a8b25d3087c0cf7494aa42f872ee72dae4c8adc3060a141d65d029031955906acd9b7b60407bd696a20688d25109cb0055c43f3262b67c4c6d0da1cd6d60388dcfe5431df7c1a32a9b60bd930b70bf79138c25f38604022d5eaec14f175aab58a4e044d1fe4c6918459fd30e73dab508b94fba643d86dd0e6243767ac88ccd28d433496e71a709c6c52c0076ce7ed6450d2b3b322a691e000011d70daef0fe3b1cbc73f05fe631d1bcd1360b9234469849b08d68f9fac265be8ea2815dc60a53fd1eeb9d3bd55896fa3c5743f587af8c799a6788d083d1ba9d96223735cad17ac046b75d975765c7817a5027b4999bda9e4a26aa020b63595d6f3b50f0ade2b4d66235e3dd8a2840aa0b218aae98218b2fa9b6a7f9ab217f2c43279bf8f260f1dbc31f96e4fded5d666bb29fe66e81ff2642b9de74c5b001d61619e6b90d879059308b3c7e788537f4955e0eae16816063703a44a51de6d161820f71ca597213f4b48e5d3e2d79fafe6fc42914f232822f6ba5d0df88ef3b9e824ec1d0a2a59704a0780562513540a864c650fd9a293e870e556771ececc756ab9e33b166a31933446a066de03fa77f0b41b41fcb0708ce7bf03d5a6e3e6a3baf1df5b1a266ca7670a15666c8dcd62e712ea5f5d7245dd1e1987da48a08241348ab3dd84a6c386cf5b3f080bcf1dec3d843462cd24955794fe76a6865b1368a25398540d2c1ce1c2149fae9757da0addbe681fea4a314e3b52de9d73b228ca24a0c53aed9f715c95f3f6795bbfecf2ed88c3cda95585a89a85302862269bf99676a95da18d8c5cddcf27f4775f629581435a961bd929609db6c08a4b600b713bfe7f313f917cc9df9fd73c64119aafdba79163524d6d9ba217d8119cb3189ba47680a007e30522f6171141e330e91c8f6e0958bc0d0324853fd82232e784dd56d8a20cf36308975b1a510672478181e64f1900a4fc16927d35700e6d8b8c8b8e458d62992508b579cb2b36a870d92804798d9f5ca2113ab088fd06d7b04cf9a2f9dc0aa7d23f3586faca692fc733d0dbcdc66d0095b801feb3934010f5e8034e08af89812c64d79570f11d056018201386a97730895f31c58e21079c3ab720d0a60f1f9b12310687fa12a02463848b06aff07a6e9e2b4cd4774e298f3eaa7074e77395e0264eccf4addd435dd64212da06ebe02ac7c19237d2972c2f7bb3fc6a796b99a0eeabedfe35c6771e7a784d314b041a0ec1116da39fe604ae479175b609f16832ee69594ea738ea300e693e82db41d2c677d32d523b8233b2bdbc3236d1b74c17e1e20100460a452e03df52868e435688078600fe1e76be1c651425b097dc6b15b1fcf056e33a11ca33e03db9fec4a0f8c8b2762858f4ed4996120d239f57b67273d8d9e1422f81557fbf2b435e96c437a06e68ddec059b2a88646b8a81c12f42a08b311d15c0f8cda3857f48010abac55cee2df7f2195726c1d012c8602b164430cf040d5a78308d8d2752a87de8c46cff8cec0e54a5d40853f780273682e66fa507642f2e0888a110068444105bdfa7a450471a395dbaa9b30ca32c8d20faeeb1ebfd4b7cd0580deae21cbc986ad3165562035b1e0b6c2070751fc56431c046cc291e4d7870fce5535e049d39861bda942a54bdfe971ef23f2cba394136b3c0562881b6daf1ff4d3d28a75b3faa4e0dca313a0c57d8115310ce12c85a309a4b94f4e72a1dba9c3954ab5d7c2995b78eb349c39bba9e47411f9fd2eae450dafe176853daee6fd09578932d049fd600562d16d851944a6b49f6dfd001b90bee895604d9369c338cb0746c62ac7a1ccd9957a38f3c399d6a66a4116227dc0a0e82d43656317fc94f74eb8e5fe46b9dfc82157abf0dfe3186b0d36c920de8f50db89bdf73aba20241583062366bf4502266afafd649891651ebc2b7e838a9027db40320a307f35eb17e413e9af0cf5593ad465107096d7520834a8e66fc93d268bef0f1308899e98cc039b2766e2f40c671355239d5cbd1478fee223c81f0f4c8b2c30ea50319f58f52ba9fd715bc0856b2225906fa9c4fd0c5936c2df6be8e32dafcc3b1759e94cd1b75e7e1d8366661b599b38072b25900ed9dfeecbc893b0f049a731b7a8c35473cdf6a0962872c2c03a3074ac73502edbbbbbfc0ec8c012e3f994300c8e329a4ae6af970aa590c60541c50a96570ff749c022da5b47e5424afec3484185137dc3f44e4fed022c238ee2d6200171dd09555851fb2b07d3b5814a2c9a50383dc9ecb5f9a29bd18d1359a6c4b914fd0e13c16a6f45faf39c54cad0ff25f61c65ab6d02017bf81ca1e8969dcb52f91be435bea6f9d49e214d11ef16001072cbe3c6e32cce57c0ee0b050026939c349b2280eb16247265039325a623b8e05c93bb9ac1f71ba0725258eddae1fd99dd9cd941cfdd29a8601209547b6db8ba8834654046168a7787e2bf32e7971e5e2c710e9e426507ccf91cebbf24ff154568ef510419dd4fe88bd214c3d07b67fc624a458170bcc7f5f4d7cd1c83b970a1e0524a9510a601548555356a30eb5091e69df721ae3fa3a47f9e2f60132cb9457dfbe64102067978744fbcffb273b0c1c6fa8605de4991ba9dfe008d5fb9abb6414003e42772e88e83530e43c84431c7bc1994b05a75d6b13c046a4943457593f017fbe3054f4f618be6680d44af44c4036374251e6574779147d4b8f52372bb3f9cd1e72c1bc7f85577ffef629d7104f83269036244ce1ec10a0062c9222fddeadf891532b86c5c70598576cada11daff2d5ffab79bd70599011613a1a393d303e9383a2744224469ec6a1605cc137c96f047c90beaa676e61f9c773d3ce2b90e98d6eb53cfb5d2f49b2059a8a408a7e1dd1a5cdd1e9a48c931cd99fd2be75bdfce4ec7d1dac0f9a45a6894ea60bd6c81dc57533b5e67a34ba7be7d9f189b6c2b672bc8e474381536760f3d18819b5534d308bdb8baacf332540738a47bc80e82f23389c0d38c6a32107933912cb3c675c9807252ab2de793eaf225efc93453579879e60a6ff22c5ffde2ca7b01451e8e8c2c01711c5589b6612d15c2b28400b6f68cf8a20a97d85972d30b5bcd02daa032975646e2250997439b26b0928ed627983f704c1494cec4e60fdf45ce6908f22cee977c78df7ed89300fb4ff31872847b0001d610f8501c2f4c5d931130d6f692a486f0653da71dbb7e00a2de843fba42df811ac30b4768e8f645d9cd0e8d3674c72cf40b3748217f17ab1fcf77ca6aba58ee80fd17c60ceb91799fb03003ed39d1a8c8eecc8585342f2335f42103bbe39c9aa4f32afa65e801dd8ba7565b95d1068e53dc88de1a977642eacc6715aa713dba151cd3ac9e8c6647afb125a92278627700846811a29511a1454cefff17e46c1fabfd3dc41c830f22d1e034be21556e1ce87dc6ceed03c0c131767c49914cbfe87290169f3d1f523ee2f9d404b80a280883b99522f0d2239701f2a893c4eeaa4b6a360cd40276c8b32fcf26c9c0ecc462ffa02d0b360d543a93546a6801997707b7a3e271caaedc156a48a707d1e82389d34fa38dad220d83a0d599ac6e5350fc5e10172c226a0c994220add343b8d620ac9ed0c9e3d7fe423ca0a345e8111aa1a7af1a5b4055c85e0e9d85c823648bb6d85ee7f728d7ce8207ecdb9f11674bd164503c0de65107550386bb8dcbbc8cee18b262ee6ba6b5e746afffe81e91081ab6553c92636c86e4f2e2b5ab40f4620df839e7e0827046ead9f3f7360bd4b91bd6d207ad1d07db2e9c09e8fd8ab8a6e35d3e6d50abd013e523704a0abadf364204e381557708f8ce5bf01405268103106bcbfcd5de6361550d9b490b74e7e13a0428313f4b98effa287f33bc86afd524dae49c55652392f60146bc1bb1c3fd1439e2672bcf8102cdd96b5c9f0352b7a0a55e1c62aef8443cf076df77beb0f13e7933896c179f0ac2a7b4728ed9e40000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"hex":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff020ae145e8632536e224757bd032e072746d30abf69b354988400edf39983f008793084922fb4232da7c9d12c88dcbf329175771bf4333bbbea23343e86023490253b4037400a34d389ced89874ab4fcd56b4a6b5d224c6fbe7e35598a27819b2c3c7a211976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b4000000000000000000100004301000173423ed95c29c059e93ee3becbd2a5e92cbf9e4ff5e54295c6602b7e997276141c367723a203679ef194e21280e652387926a586a3561ed9d3ec47b88eb18bb6fdcd0d602b0000000000000001373b0d3a0ae0e9b18d3b990f3050cd390391943ec0858a96a05f39900b2b46e60e7d9af5ebefecf46ada21a5cddb6d60b7df85d6896a4dfc2a3c0c452b7e1024805603253f2a1768c59d3dfce39234bec188a9b3f795f0dde4dafdc477942ee36698556e39eecf5c327cece7e05b912d254fc0cbd83dfb3f41fdc8b8ce43221cb06a82be5e05891517a78c3b9ca0c55266a9111603dc0ef78e19761448403cf4b104b2a4acd0bdecb45c3b35c8eaa024a5db7891c1a8d3282c3f7406e770ac9a6fe5b7e7a6abb1446badbf1feb0a1ab707d6ddee05eaf62ac45405ee45be142027cce0ca05d92368d30a0a9423da5d71edb75c221763c8a6703e47d1a958fe7447f9c8d8aadf1c29b45d3cc32d4ff40cca9c734347e0c5549f98d8b461141db694b6bda0f71d6891561ef4e000917ea0ab571d13ed81ede908b34dccb7e1c9f51e151d912bfeeaddc848066bf04c8eb1751ec15bbed66f8e787db2a152161f79f9a459870c713684c3f2c9537fbf7c0f932e47eb478fb78e9cb98a6a0d64a08b61070d63e244eacb01e12d2e6cc03a312589130294e4dad665051182367b4fb468f135ae89a77670365317d0e72a992dccbeca32519f755686ca218572e9a95ce129c09dd5209202cf4a234a947738efcfe4fa1009e02267ecfdc434a3bbda321664c63420607f2493d562df2ad42d3eb5dfcf5cd59820b27f1f87d4cb887ba833c73ecccf90d61d13f67484c0169cf27bca2ac6ce4898b07a035508382b932395eaaaff852be4faabee9023679a2652892d2e43e4f77bed08a25a5b3576a318c2e017c1a4f05597760b0ae7b484a0fd32777ebeeaa4ee94f8475cbde545469f254d21b36dbd590fc6daf68b58f694cfd42054e8c03fc4f72631a977ed5a6097516c56ebd6bde09b4db18a8577e3d948660b0ad2f3f86c75e97d6845ee98874dd88a934bf5f7b43fc029f0cf04a2e91caa881d87875fdd32c9f9097f29e9e72d08efad9c2399eb58d6df098cf004845360a8b25d3087c0cf7494aa42f872ee72dae4c8adc3060a141d65d029031955906acd9b7b60407bd696a20688d25109cb0055c43f3262b67c4c6d0da1cd6d60388dcfe5431df7c1a32a9b60bd930b70bf79138c25f38604022d5eaec14f175aab58a4e044d1fe4c6918459fd30e73dab508b94fba643d86dd0e6243767ac88ccd28d433496e71a709c6c52c0076ce7ed6450d2b3b322a691e000011d70daef0fe3b1cbc73f05fe631d1bcd1360b9234469849b08d68f9fac265be8ea2815dc60a53fd1eeb9d3bd55896fa3c5743f587af8c799a6788d083d1ba9d96223735cad17ac046b75d975765c7817a5027b4999bda9e4a26aa020b63595d6f3b50f0ade2b4d66235e3dd8a2840aa0b218aae98218b2fa9b6a7f9ab217f2c43279bf8f260f1dbc31f96e4fded5d666bb29fe66e81ff2642b9de74c5b001d61619e6b90d879059308b3c7e788537f4955e0eae16816063703a44a51de6d161820f71ca597213f4b48e5d3e2d79fafe6fc42914f232822f6ba5d0df88ef3b9e824ec1d0a2a59704a0780562513540a864c650fd9a293e870e556771ececc756ab9e33b166a31933446a066de03fa77f0b41b41fcb0708ce7bf03d5a6e3e6a3baf1df5b1a266ca7670a15666c8dcd62e712ea5f5d7245dd1e1987da48a08241348ab3dd84a6c386cf5b3f080bcf1dec3d843462cd24955794fe76a6865b1368a25398540d2c1ce1c2149fae9757da0addbe681fea4a314e3b52de9d73b228ca24a0c53aed9f715c95f3f6795bbfecf2ed88c3cda95585a89a85302862269bf99676a95da18d8c5cddcf27f4775f629581435a961bd929609db6c08a4b600b713bfe7f313f917cc9df9fd73c64119aafdba79163524d6d9ba217d8119cb3189ba47680a007e30522f6171141e330e91c8f6e0958bc0d0324853fd82232e784dd56d8a20cf36308975b1a510672478181e64f1900a4fc16927d35700e6d8b8c8b8e458d62992508b579cb2b36a870d92804798d9f5ca2113ab088fd06d7b04cf9a2f9dc0aa7d23f3586faca692fc733d0dbcdc66d0095b801feb3934010f5e8034e08af89812c64d79570f11d056018201386a97730895f31c58e21079c3ab720d0a60f1f9b12310687fa12a02463848b06aff07a6e9e2b4cd4774e298f3eaa7074e77395e0264eccf4addd435dd64212da06ebe02ac7c19237d2972c2f7bb3fc6a796b99a0eeabedfe35c6771e7a784d314b041a0ec1116da39fe604ae479175b609f16832ee69594ea738ea300e693e82db41d2c677d32d523b8233b2bdbc3236d1b74c17e1e20100460a452e03df52868e435688078600fe1e76be1c651425b097dc6b15b1fcf056e33a11ca33e03db9fec4a0f8c8b2762858f4ed4996120d239f57b67273d8d9e1422f81557fbf2b435e96c437a06e68ddec059b2a88646b8a81c12f42a08b311d15c0f8cda3857f48010abac55cee2df7f2195726c1d012c8602b164430cf040d5a78308d8d2752a87de8c46cff8cec0e54a5d40853f780273682e66fa507642f2e0888a110068444105bdfa7a450471a395dbaa9b30ca32c8d20faeeb1ebfd4b7cd0580deae21cbc986ad3165562035b1e0b6c2070751fc56431c046cc291e4d7870fce5535e049d39861bda942a54bdfe971ef23f2cba394136b3c0562881b6daf1ff4d3d28a75b3faa4e0dca313a0c57d8115310ce12c85a309a4b94f4e72a1dba9c3954ab5d7c2995b78eb349c39bba9e47411f9fd2eae450dafe176853daee6fd09578932d049fd600562d16d851944a6b49f6dfd001b90bee895604d9369c338cb0746c62ac7a1ccd9957a38f3c399d6a66a4116227dc0a0e82d43656317fc94f74eb8e5fe46b9dfc82157abf0dfe3186b0d36c920de8f50db89bdf73aba20241583062366bf4502266afafd649891651ebc2b7e838a9027db40320a307f35eb17e413e9af0cf5593ad465107096d7520834a8e66fc93d268bef0f1308899e98cc039b2766e2f40c671355239d5cbd1478fee223c81f0f4c8b2c30ea50319f58f52ba9fd715bc0856b2225906fa9c4fd0c5936c2df6be8e32dafcc3b1759e94cd1b75e7e1d8366661b599b38072b25900ed9dfeecbc893b0f049a731b7a8c35473cdf6a0962872c2c03a3074ac73502edbbbbbfc0ec8c012e3f994300c8e329a4ae6af970aa590c60541c50a96570ff749c022da5b47e5424afec3484185137dc3f44e4fed022c238ee2d6200171dd09555851fb2b07d3b5814a2c9a50383dc9ecb5f9a29bd18d1359a6c4b914fd0e13c16a6f45faf39c54cad0ff25f61c65ab6d02017bf81ca1e8969dcb52f91be435bea6f9d49e214d11ef16001072cbe3c6e32cce57c0ee0b050026939c349b2280eb16247265039325a623b8e05c93bb9ac1f71ba0725258eddae1fd99dd9cd941cfdd29a8601209547b6db8ba8834654046168a7787e2bf32e7971e5e2c710e9e426507ccf91cebbf24ff154568ef510419dd4fe88bd214c3d07b67fc624a458170bcc7f5f4d7cd1c83b970a1e0524a9510a601548555356a30eb5091e69df721ae3fa3a47f9e2f60132cb9457dfbe64102067978744fbcffb273b0c1c6fa8605de4991ba9dfe008d5fb9abb6414003e42772e88e83530e43c84431c7bc1994b05a75d6b13c046a4943457593f017fbe3054f4f618be6680d44af44c4036374251e6574779147d4b8f52372bb3f9cd1e72c1bc7f85577ffef629d7104f83269036244ce1ec10a0062c9222fddeadf891532b86c5c70598576cada11daff2d5ffab79bd70599011613a1a393d303e9383a2744224469ec6a1605cc137c96f047c90beaa676e61f9c773d3ce2b90e98d6eb53cfb5d2f49b2059a8a408a7e1dd1a5cdd1e9a48c931cd99fd2be75bdfce4ec7d1dac0f9a45a6894ea60bd6c81dc57533b5e67a34ba7be7d9f189b6c2b672bc8e474381536760f3d18819b5534d308bdb8baacf332540738a47bc80e82f23389c0d38c6a32107933912cb3c675c9807252ab2de793eaf225efc93453579879e60a6ff22c5ffde2ca7b01451e8e8c2c01711c5589b6612d15c2b28400b6f68cf8a20a97d85972d30b5bcd02daa032975646e2250997439b26b0928ed627983f704c1494cec4e60fdf45ce6908f22cee977c78df7ed89300fb4ff31872847b0001d610f8501c2f4c5d931130d6f692a486f0653da71dbb7e00a2de843fba42df811ac30b4768e8f645d9cd0e8d3674c72cf40b3748217f17ab1fcf77ca6aba58ee80fd17c60ceb91799fb03003ed39d1a8c8eecc8585342f2335f42103bbe39c9aa4f32afa65e801dd8ba7565b95d1068e53dc88de1a977642eacc6715aa713dba151cd3ac9e8c6647afb125a92278627700846811a29511a1454cefff17e46c1fabfd3dc41c830f22d1e034be21556e1ce87dc6ceed03c0c131767c49914cbfe87290169f3d1f523ee2f9d404b80a280883b99522f0d2239701f2a893c4eeaa4b6a360cd40276c8b32fcf26c9c0ecc462ffa02d0b360d543a93546a6801997707b7a3e271caaedc156a48a707d1e82389d34fa38dad220d83a0d599ac6e5350fc5e10172c226a0c994220add343b8d620ac9ed0c9e3d7fe423ca0a345e8111aa1a7af1a5b4055c85e0e9d85c823648bb6d85ee7f728d7ce8207ecdb9f11674bd164503c0de65107550386bb8dcbbc8cee18b262ee6ba6b5e746afffe81e91081ab6553c92636c86e4f2e2b5ab40f4620df839e7e0827046ead9f3f7360bd4b91bd6d207ad1d07db2e9c09e8fd8ab8a6e35d3e6d50abd013e523704a0abadf364204e381557708f8ce5bf01405268103106bcbfcd5de6361550d9b490b74e7e13a0428313f4b98effa287f33bc86afd524dae49c55652392f60146bc1bb1c3fd1439e2672bcf8102cdd96b5c9f0352b7a0a55e1c62aef8443cf076df77beb0f13e7933896c179f0ac2a7b4728ed9e40000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign legacy p2sh',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"isWitness":false,"signParam":[{"hex":"54b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c6717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb26","type":"sign","derEncode":true,"sighashType":"all"}, {"hex":"2102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906ac","type":"redeem_script"}]}}'],
    '{"hex":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb56010000006c473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601232102ddeda4a5b67955c32247c28379cf3461c872e34f96ec94ddd61c66bbcfda1906acffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000"}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign multisig auto',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"isWitness":false,"signParam":[{"hex":"OP_0","type":"auto"},{"hex":"3044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601","type":"auto"},{"hex":"3044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601","type":"auto"},{"hex":"522102e9662b666479ed7117aa76fb96f322a84408d0882707b301c7450098d439680d2103c0230a322f70675bef21097242ac70647798826588e47eca14e5715cef77008c52ae","type":"auto"}], "clearStack":false}}'],
    '{\"hex\":\"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb5601000000d900473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb2601473044022054b6116e20efb6da997e4fabe8e0af10ecb7b9d5009050795c21475ca4c6f3c60220717787bc18eb2064b49a18cb8dec8b3bbaeb68ea71c58fa73bb1ec7e19d2cb260147522102e9662b666479ed7117aa76fb96f322a84408d0882707b301c7450098d439680d2103c0230a322f70675bef21097242ac70647798826588e47eca14e5715cef77008c52aeffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000\"}',
  ),
];

const errorCaseElements = [
  TestHelper.createElementsTestCase(
    'AddSign empty hex string',
    AddSign,
    ['{"tx":"","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty data."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign invalid hex string(3 chars)',
    AddSign,
    ['{"tx":"000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"transaction data invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign empty txid string',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign invalid txid string (20 chars)',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"ea9d5a9e974af1d16730","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign txid not found',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4d","vout":1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign append signature to invalid txin(vout: -1)',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":-1,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Json value convert error. Value out of range."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign append signature to invalid txin(vout: 1)',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":0,"signParam":[{"hex":"11111111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign witness stack empty',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"witness_datas empty."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign invalid witness stack hex (3 chars)',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"111","type":"binary","derEncode":false,"sighashType":"all"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign empty witness stack sighashType',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":""}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
  TestHelper.createElementsTestCase(
    'AddSign invalid witness stack sighashType',
    AddSign,
    ['{"tx":"020000000001319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000","isElements":true,"txin":{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31","vout":1,"signParam":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"abcde"}]}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
];

TestHelper.doTest('AddSign - Bitcoin', testCase);
TestHelper.doTest('AddSign ErrorCase - Bitcoin', errorCase);
TestHelper.doTest('AddSign - Elements', testCaseElements);
TestHelper.doTest('AddSign ErrorCase - Elements', errorCaseElements);

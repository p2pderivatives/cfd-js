const {CreateElementsSignatureHash} = require('../cfdjs_raw_module');
const TestHelper = require('./TestHelper');

// テストベクター参考（https://techmedia-think.hatenablog.com/entry/2016/07/08/153449）

const elementsTestCase = [
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2PKH) SigHashType(all)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"958b8881d942a3019a674232395a89c25cab567a63ca2d9a88be411ee5d46060"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2PKH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "confidentialValueCommitment":"096c711e318b1b540f683aa3ed570c571889417483979e24403e47d8be7c2ac664", "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"958b8881d942a3019a674232395a89c25cab567a63ca2d9a88be411ee5d46060"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2PKH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"02000000010109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff020bf7695ef92dee6f25ce42d1d8063be6ae6423aa188743efa85ef71ad399c45f37096c711e318b1b540f683aa3ed570c571889417483979e24403e47d8be7c2ac6640222eebbe8bb97147e330aae07ac5e3734c2da7c53b13ab5651172505607ed52391976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a1200000000000000000000043010001a5bf9b5db77f85d6575797d779f75124e1be76fc193dd0e5fa1b10c0638ac5b247c7569cab89a322e01ee7abc8069e52ead896a92431a07e157ba8a039a465fcfd4d0b602300000000000000019fb3013733b55c0534207365edd39c77b0ca2c58de4e3bfcf08dd48183f20d7ed313dab7d1543a4807d74cb4e9c1482dada84f2471d0c6c9f5802b3032fd3408dd4b70b2d13f4b194327599b2f30c4c3bd89f3e701114061e661d212d11e9cbf7d26f9ed1832da4795a30a28218b0748bffa983f30bb20277d7f8bbb4af8c25a24aea240dffc2cf8d363a8fb6ce8586f66fc7954bacf7b8a4a428ea49776494400deb61348379ae716a42115c58ec7716d2cc91c709de4c9ad6fa91adefbc8b08faff1115feb3fdcb9be4f056c636c373beb1fc3d5855f4d2940e75a469102a7f4aa36829f6e3ac9a97d9aab7c4186ab821bded630b59174126d4ca62e9c7b80a47447483d088e3327f19159ee31da439f4f2feecf3709652695ae8339b2f1986223b5fda58acd3b16b4d9ab6ed17d3f1cfe06b6c89ff34264cf4fd4deec9588056ef770aa3f3974104cf3081aeba69de8f23ab11d5254599906b8c9669d503fdb2f017b4ed1eccca1e3ef5635a7d4a823a5e36f5e0384097485fa0a5e74908b59ae76fde5aa0be2eea79853b01b21a247ef9ed74637681e061e7bd185fa180999ddc004e9b565f41bedac90a34dd14fd5db1befc5dde55f51ac563417c33d1dc5160f7b5e7d3f089cfdbdad75347f03478915de31c2354d3d34741f1268d5d4433cfcc7cf7234bd1c1ed205da435b30739c1018325e68394fa30784927dc5410b72dea15effb8f37f20b6b2e3b955c12cbb78293cf6220123e656ab373cc646326318fb8ac7d94bd60e643480eb9113390fc40b65209e786e8a3334a43e7fca495c7e897d78cb3011c2e54deb083de1e9219aa7b900648e80caebac4d98548f4e6b386f10db93b6920d9c8e1ea464ade3b8e31d6a8035a28789e2cbb691f0ba4dac9935f8b5f7e4b92b181579ace54ec188b3a289c17082da8fb1d7542ae2162346c561aa6728c8f2ddbbb4e1d61f561491003ab1c3a894174333518ac3a73204dc115d8da71204af3e6d56164a8d2b8caaf0a0c7d6fc905839409aadf2a2914e8ca1430258947bad32525e33183b3b2b33fda41e4a10218376a30d7488000b33a9420eddfd7044f07237b80ffb07fba1fc177fd4f6aa587b7a38f4cc2746df6c2e2b25195a369e33fee10884cf64bba771e909f385faf8f880ab5b5f76fe8d98fc6c61214908790db604327586130f9d662d7df2c466b6cb9e4735cb8ae2f33661ecb1183c5accd6c0f9edd3b72782040d5109fab5f34c57fd060553bdd34e87a526d0d31fe81bf18ca594749fa6b61e080dd6b2d6a780d1c64e7dd4ac927b3c3cd64631bed3474d0346dc2a476dc986e11c84540933d63e0c801d959fac7590dcab69088a5b4bcf7ae5e73f88f095811c677fece06265a04707f27997a5a3d4e449a0bc3bdbabf1859e506435c0955e2cae811ab3d7de431b1cb4404c1e017a77475fbf335015d6c4a134b9b089a88ca4cbbbb10e7c32d73f9a88e639ea82819fc568d2d5d9cd937d1e86563a1943b6a3ad16e6c2656934d248e80d50f9953dc6cead7696f617c6fd6521b217bd66da663c59fdd9017061ca50538f0e48f9d5b7e65fc804cb31d8fbb7a0d1774a9bf8f13ab5f9ca26fdd830a58327050d6eaaddbc079e27d5304bffc72bc58a2ae998d92429768e070c5bff5afa04323dd1cc0be7fe81813ce7f00d2e4923d8c9c13f6ef2c564ab2827799f809a5f9e2343f5b21ded0b4dea116e1656770461b41403ec400b6dee1ff188959c4928189f889c067d2e6e82aecfb539a6a7cf966e5395d7c18aae1f2e51d7311a0a27124755b17dc8a8630b50e8db61cb202e51641bd24df092422b3b5f3dd068e50ee95d4783f62ccf854edf43a88374190b234d56dfe46722cf166e00cbe32652804e3317cfff79a144b74a0b70b8e75860de4d4039971cb2ae0ed7274c3eecb4d9c3509f97f7676a700c4495a9c82623acfdce7d154bdd7fee554aeefbe4543e2b3490d9c40f6b9318c8a311c9ee0870f5b24823d78bab14bb0ce85516a6d7fe127876a2804aaa36a5a2502bd43185c9a6be14b24bc3732fa03e5cae0e0f3bc886242fbac040e695d2005def13d7678851fa5f59c891095e8ba7e83c3148062d76ded1268a46d364f73a482094ed22f9624c409cfc8c57d785fe31cace715565b9121c27ddd5547570ff2702b886b934706e17f12f595cbefcfb4697688d6594e34c9be9d8bf411674e3eede8dfeee392cb857382b7fd5bffa7749d9eda410618b479c47f21e5776c56d296b35d34b1fb78953bf8022f13ea53aaf6542fab8a72d54d3658501c18fd57b7e84e4629950f042a6cffb41a84f1ca39dea96776da120a592a070bad11a0e26af99cdb3727adf5349c96c373432861c9a22ca7e5ad5fcda225c5656885582d612d432334ca12ff10f23601764bc221b4da9d83aeded89e8e1baf346375e5d4003a19b3e8e3a599135063bc491853dc267d1e34b17704ca571c1ce057c7032e56ebe79721dad95d1f595f0baf05ff00ab8e3bd7da884210d0230169b6bb0f0b7517fa7a4e1cfaaab1772fa486048df071eb8635bea0f5c2c477d90251de1dddfbfb8edc16d54257d61769bfdb53b51e3d187f3891f4c720f4f9760d8ff5bdd7846d7231893270d1f1156148fb92ea7b2ab144cc966b1c98deac160e3477fff71209fb043091a9e66861dd70e3216f3dd30ff6cb2fe86d3905d390ebfd46d6b49f18f576b06558a8a1235ba1662ef773901897978709c435eb24449d7efe40ecf774efc2932766f8fd92ac09be3affc8b6c4170a858835036b58399b90feebd5cf13d5c04b469f847d1f7a17dd7a28185e8516d72d2687af9437063d9e66bff2f801491b3b4a1453f7ce0ba0452ad9150752a5c321b63bae4e4d4aa6b0be79c527ece1d258f2dad6cad725066ce9b0b70c2112661b095390ee0508150cfedd946e6e615a54bb29eda8a7b05c7743d2e09cd94f4ef797a4d4cc9c3656483b287b0eb0e9afd5e163bec152030fd026b5853a9346d917337e2f8859bb2e67de838144b2889cc854eadedd0295ebf8500e52a5dc2486800f1eb513ab11600c6bff78e8a95b69ac80d1a356cb9bbab36993483036581515f43872713fef20f5c783c1988761e1c1ed0c77bd27f5f416c947490938a8adc6e3be1d340a6c4e4312d9285d5c61348c287d7b229fa0979a4b739c1829eab31d8b84a0e8908a66d084cb1467edcae7a9037533ebd4d91f525c8cdcfa7eeafa3f47cb0dd181b9e1be8c7b153afcd4245ac5d6c9411d8f52e8a4eba72044e05e45910bac5873b7f6dca604557638a24e9e93afa93855385a98134365ad5cd990c2149eeeabf7290ab33ea0de5da6cf997e049c6d875b02d9a1f41bc2c98dae3aa556a89ec7b7c82f428cec4e8b8a2e7594cc186d9879b02cfa6ed6083f7a098547af29f321f87fa19efb4fa2e9382499b95958a8119b9a9dae76a94505e7df7cfc277afbd12fc6b29d20186f1db8d000ccd1279fb0d0c549d961af5ebb066ea5c8a0f26bfbfeb019d6f66013423369a045a37de8d7149561db25a386c72c0d7df3c194e8ac55fb0daf9b270281188aa7b43ac40aa2f68f130a598f3164bd3d970c1885f97d1d78099c83b894dde64b773c7d6c3fd9aa5da3fd8e70ce7aca12a920e8b0288a099a94c9812f654d0f48b6448dc295529bf07a3f75a3c5240cbbec0ad61a966b163e49d8fe1c836ccabaf2e98a7bfa90b00b905bfbaa8dc502c5285df46919c564d9e1aeca3b8f540e7b3ddb990f3cc84277f07dc095a950c418c57e23aab03cd5f12285c0e9961657e548f2fe699921a611639cf7719956869cdc8dedbe6b941bd381def7a0a71c6c3f8cfb18d12c63839722a25f908748b780bfafa564ec54a97a6fdef09debf6c2ce9695c5a3b6fdacb968a4b9d7f8fb6b383312e726eb3b1c364b52e4750d22074af9dccf29b499a4419f1110684d06f41388a2e80a806fa10f470aa9b7fd730abad59608211289976c70896c80268e27741eda5b93df855f668880b4cb12a304d0f69a10c9c5a6299ee37636ca2fb1fac1174f97f167fed8ae4cbc50000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "confidentialValueCommitment":"096c711e318b1b540f683aa3ed570c571889417483979e24403e47d8be7c2ac664", "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"a48b944d32760edf3c12e61783bef5d9524800e668fcf92e3a3832219ba9dd1f"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH) SigHashType(all)',
    CreateElementsSignatureHash,
    ['{"tx":"020000000001270aea6f10688daf5d2da51b753fe2a6358d4f290b5e025903b4ce54c90f29e80100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe003c16a227c5c4d4b4682b71ee7cb809102cd8955b888757695898ea994bf74ee711976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"e8290fc954ceb40359025e0b294f8d35a6e23f751ba52d5daf8d68106fea0a27", "vout":1, "keyData":{"hex":"52210218edb5891db05091053f65d3d346d093542dd5c149bed83774d7ec2463613440210214f7f9c556eba0e45a1ef4da90d2df79f670715cdb027a44f5f376e17e5e591c52ae","type":"redeem_script"}, "amount":100000000, "hashType":"p2sh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"454f8954b3248ccc43d6ff9ed3c93349baa96057eac35edaccd8a748318795a5"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"020000000001270aea6f10688daf5d2da51b753fe2a6358d4f290b5e025903b4ce54c90f29e80100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe003c16a227c5c4d4b4682b71ee7cb809102cd8955b888757695898ea994bf74ee711976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"e8290fc954ceb40359025e0b294f8d35a6e23f751ba52d5daf8d68106fea0a27", "vout":1, "keyData":{"hex":"52210218edb5891db05091053f65d3d346d093542dd5c149bed83774d7ec2463613440210214f7f9c556eba0e45a1ef4da90d2df79f670715cdb027a44f5f376e17e5e591c52ae","type":"redeem_script"}, "confidentialValueCommitment":"096c711e318b1b540f683aa3ed570c571889417483979e24403e47d8be7c2ac664", "hashType":"p2sh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"454f8954b3248ccc43d6ff9ed3c93349baa96057eac35edaccd8a748318795a5"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"020000000101270aea6f10688daf5d2da51b753fe2a6358d4f290b5e025903b4ce54c90f29e80100000000ffffffff020ba78a3213603c5a9fbf867333729c40382166c1c58bb682aa82eae05030b9589209fd0e1ede9ee0d1443069e35b4c5be378179af6916300d9b1a28ebaea45a7d50b035d91aa8c2a2c81755fa07b0bbd313f1720555a0bda563f53549d3d066e107bed1976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000000430100018a5948c4e0086942271a200c6de8484dbb6ecc0d06855f0f34e7a5621de9378c447e844eec93b9fc5c21a142123b52a8dc39a9c692b970602318ff74c7d9f044fd4d0b60230000000000000001179b0090e7a7c7de97161b61b2bbb09d0b492b75d0e62d491343ac6cc13c8d0756147be393628b64bdb206ae85a6242328f7f9006edb69623ea54e698a2b9c031397da72f0dc0286c31486286715dfc55210485ae6cc850b418b8c7e02af2441a25ff855d14d2ba014d9b8a9a37efaa76ad4d7cf0d5ef48d445acf5ad874d1ee9d36fd22cc4d43d45918d4377f0095818bac54570c0ae1a7d32957290d4a29a0129911cb67a5699c76d1cedb0566a831b7066b97424589d4162e9ca068b435b5d36ab3be18233d84f3a774309463ca096332a7efa4e8df8edea3b3df3481339260c2c5174ef675e3d452624bae9703d6e6fa06c225ceadf4ccb80f7b242abc8548da90c471065fbb8cb0f8a3b61e3bdc7e18d5c5315c1749df74979cbd97c3bcf8593e5617684588f0296812519adc71750e7fba131a8d2c46a2faf63b63de20c35da983e1395ef1d93e78273f6c7c980246909e06d2583d505e545d063f54d7f6199ce2aca5c6c5cde3a9ca6fcb1d5d223c83fccef4c5edfa2b60639e3ee5aa213ca1bde271f9e4d605ed1b1d17a91a3f3407333e535fa9da1007da36a7b23eebb11f6daf7d0911460c41a91a0c6d8d3cc3516757d4d9d6739ef5b58c3ce59530b452f3bb353068e97f348d0641c9792a60792c2925e054741149bd9771ce43c1a79e28a348ef8465e763ad9b6afff025415ca5da827bf1d98be020fbf988ddcb1dd215513096b3473d6124f63549af6e2416cf0123d0d3ec46a9b9eba9c407ee3ddbe87878dd03b705418caeb7e7cfbf6b01840cb1d645a685899880159a27b4ae549ff00fd08d5f80f4b6ea05c32ff00d1267bbf919f44fd2dc9a626d80fbcf1b371df2e1e8c8e62b16b243fe922982ad010917b71c839f2be5f0a4b4cec3633376586063e558c832508108f7be2990f7745976a03dd83e7cf15e42ebb87402c979775f82efd6085bbe709f3bea23615da30d949e5fbb6f866b28485b86ab4985425b59d8ba37ffd8bff5c596ae48aa1937c664ff5ddacc5f7169c3f5fc40687be6f0b10749ba947de14ae525d231ca20ca5319dabc994400fb44bfa9f3aca7e3e5b30dcc121368f706bd76c0b79df865be9339f238516e9567576d84e81e66a448994eb7de6fda7f616a0a86335dccf06545610ee6b28a518d8122a59f642eb8192ec223acecac046469dd0997663ba4e21130369045455d0145d3d82882fb01982913a3ca0f1b4432f5adc44e5a7a5cc70a53be98a53efb8902e8fa3098c979275ae37053db27c451b69932dc1abf251e276cef032675e122de5ca0172b0559b9761fec252a6240727c36ba64b1e5740a28186d1e88d3b89f5c6095596d2b544e607089fa201e0e61a00ded1d778ac5a40c8b7d42767a23348d5cbaa1eeea8c5c312e1d6479eec46fff6d411ec4be4edf5357d40ba7526d1c25a38accd1dafa025249872af7942f7a2cc98899a6a15034ef9e2ff05810d92c06a1f4eab361a2e445b8a062b3e606d1f9752826422d5c3cddcf50285d3105c15108a682f6115a163c2b765974a5d19db48b821d2d89b3efd063417a604918160469f3461571653774fbbcc8e069141125c1658db306d76db1c3a71ef32377c992621aeeaf1cee3631a736d585af2be059bb32fd918592dcaad20415c98d45d22c17ba77f498e4237c991ec782a99c7843c0673976d9284b7e6a15deca10cf14f9db83118f6da593ce43184d7defd0ee23f0c007b2ca55b7eeae932fb8f5f19eac4e003bb5ccfa6e567f60d87b9bc7c66d18f22ccd0db5093c24b955b091fd77f339b4561b59bfe4d2a202be2dce69f42830ba03bfdff77150752e20b10debb0b45db29013a6a44dffae0b59711e08e4feda0fc3a64d9ca1d63a3775159d5e431c0148ebbe31d796377b3285e8c05340cc7ffbfc4aac09a419eed7075d1fb84137a05543b22b50adc5e67bde66c85b047041b300058c7ce2323175b1cbdd0dc5546d2e345c0d2e4e80be2d62ec36ba2136bb1e51e41c15923daec09680b0a9d0fcfd1964dd1b41e214a5145ed2525906ef70e4b56b04b1ef0a3cbaf947a601c9a18f96f18b8e5db2d8687d7617e7dc2af796be2b40d2ee8ab5e0ea92b7131dd4b4ce2242757652da7c7ec0c6313177e3398baebec0b1e026ecb8ec33674cf31951da93e3e7eefda0390d98857471e60a0f3dd5956dc06a427767a7c38e4a71daa57eec1b385e74b1cf621388a8a00b5f1ed7b80b51e533e906db80f9847e25b75bbfb3e1b9958d590bca70b2d30ab2452302103af0d62422a5f6c30c93d98e1465203504e2c36383ad7970a265ab614e25829420912e3ef8078479a5760928ad107f6dcb5ebb76f4cd565e0e261d5b77940945752a1862dd45e83217cb3651806947511557caddb61a6fc2a9e2c3b16a86c67da1dc3df35a63f472725fda8bbb117161446d118f134b51502ae5ff53858f6b7bfbded498bf08f7baac5f647a448b2e90f45d118549bbbfd9640b67d784c5ab7671b10ae69a637c02ae66877994930b1a17fa70621b8ac0ba6a551fa7caada350a26d0cb89c18323a8a8a9dd46e67162b12a3c86bc8d444b08a7dd36050c197bc25b20b25c93a551beb5dcbeaa3dbaf18d1709858f381ce8e95e2719d9ddc9d3c9b474288cfad9ea031ac5bc403827a9c6205ed4358dc287acb1d4207ca91cac35c9459eeaa6e4fccae3830bf3450629bbc9ac4fb1511de7ebf27ed257d0d55850d2a90bc7013fd5c77df34ef986f96350eae5a806c28a693f28bd2bfab875e1a5373c41176bf10701ac15ce10d4e8a1a36684662994af9d6b28b115084733628c986de095f7c0cd378514b3f84d7f82f25185969a9813810b69df3a112f3472a5dd09ff516c41b2922213059c29051538a525f60145bd8b11b386b83275311e8dcf9e475b1cbfeaa4e63ece64cc66f4a5c7e229b77af299cdda6b8700668ee49dd55dc1b72c21376083426e383282fb5030f6157187e347da2b5ba3b251e6e2454b75a425d97d11e24efe640f41d4485840439cb53a56c31410552d6bfc989a7a6d587338ecc766b823028c0f57acacd3d7806df8f5e5d32af68495359db70d549e2e7c7a90d17d578a9b8b9ba34e3fa9f016ae387afa119e3f15c65c525aa8e3dafeb20a9a6655d67baf50439fd95b256cb8508aa05a72424cd9617fcd163a5e6b4ac4e6eb5a9137ee511cb8944dd3b740647000ffcafc0609ba7941d548c786e8218bfb86d15bc252ecebf20f4aa79cc600ddfed2d0969ca6fd05c0b9b4060a830a08f379c40303a6d0f69c1995e1c921d51b89642e73100732691311741dbb4a88665b25bd4acd21291ca850d2ff13e12683ff4bebe2dc0288630cd6c09c42ba0618bcfc6de70d0fb8087681acd1e139b816c813ca458b1f68581fe05959bc21b6e806c6363e9bb681482996a5cd6274b59ff9fecaaa88fb7f6d406b212a9a4259c896e8363234cbe85995ab309ad1db5125fa3fbc6f95a1d4385741168d089bc3f53761eb0c6b2be2766af694f37bf6c7e1599dd2d1060c259b2db7b3fb0cdd1cdc7313c0d18de2ea86bfc0d010aad6351d9b056b07a2a5932e41e57bb2b69168e68bbddd75deef10c6a00a07547e72e2f02d20165433dfa6a6c9f73e1c36e38fcc93bbb4a5d23beb0a3e545a252e59f8ba5245122ef2664d3b7c218a8004d8137a99b457909ebf9abd94b71cd8b6245e166f41cf4953516412b4c39d97e765915f8df2eb23410f7938f9ed1ab75c426d4fef766a3f1802e11d2573614b62988fee9966023661626a30d67ccb0f551867f6a4c2c57c253cf0f1662db0a6e5cac61715cd93bc3c6bdf19df0143f1028941c2de27b34595801574307f439424dfb3a520fdf6b3c820ca490eac2186ee130ae54f29d7b4ff9055912970009e5546e4d5c20b8a81c97ab059b8de523940d30265794b0805cf2791bfa4307afb4f7e4cf35389747cc2576728e7a29c65652e0b7e26af0f1aa15b35c73eeaace0aa33270888ea5c54ae745e404bc75c842b59bdcaeef628e20daa2510a3cd1f42a6244266f5ce0029e9983ae2487d28fa61b2b04c1b80000", "txin":{"txid":"e8290fc954ceb40359025e0b294f8d35a6e23f751ba52d5daf8d68106fea0a27", "vout":1, "keyData":{"hex":"52210218edb5891db05091053f65d3d346d093542dd5c149bed83774d7ec2463613440210214f7f9c556eba0e45a1ef4da90d2df79f670715cdb027a44f5f376e17e5e591c52ae","type":"redeem_script"}, "confidentialValueCommitment":"096c711e318b1b540f683aa3ed570c571889417483979e24403e47d8be7c2ac664", "hashType":"p2sh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"0d644513459d957551453a9a08f9c5b18a9f155122a72018c0f3ff55f2e8e743"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH-P2WPKH) SigHashType(all)',
    CreateElementsSignatureHash,
    ['{"tx":"0200000000013179fa99601c70491eb8d50cd77449e4eaf8b50ee9bc5c7a7fe7b96aa423465d0100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe003717e3f1f79b37c242a005dd0a3d223e3058fdf7aed0ceb1ea32a70771a76d9db1976a914584c05957f7310787447a5bbe45c051891cb573388ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"5d4623a46ab9e77f7a5cbce90eb5f8eae44974d70cd5b81e49701c6099fa7931", "vout":1, "keyData":{"hex":"021b35e12da3703e4b5dd0ba636675bb7c2e2431a660c44b145b0f38e7e1523da1","type":"pubkey"}, "amount":100000000, "hashType":"p2wpkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"560224c6c9ac281e4ba84a8583f60bd17f279f414a9b29b55479c3b03f778c37"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH-P2WPKH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"0200000000013179fa99601c70491eb8d50cd77449e4eaf8b50ee9bc5c7a7fe7b96aa423465d0100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe003717e3f1f79b37c242a005dd0a3d223e3058fdf7aed0ceb1ea32a70771a76d9db1976a914584c05957f7310787447a5bbe45c051891cb573388ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"5d4623a46ab9e77f7a5cbce90eb5f8eae44974d70cd5b81e49701c6099fa7931", "vout":1, "keyData":{"hex":"021b35e12da3703e4b5dd0ba636675bb7c2e2431a660c44b145b0f38e7e1523da1","type":"pubkey"}, "confidentialValueCommitment":"097721a56acc21b1b439e5794415e3cce785b44c34f03e170a46f4fae0120d024a", "hashType":"p2wpkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"c07e1e1c12dd1327f22ad642e9479d2ce902fe43a73bc930c1cc15a67e1c2a2b"}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash HashType(P2SH-P2WPKH) SigHashType(all) by AmountCommitment',
    CreateElementsSignatureHash,
    ['{"tx":"0200000001013179fa99601c70491eb8d50cd77449e4eaf8b50ee9bc5c7a7fe7b96aa423465d0100000000ffffffff020a6623115698a815045a797a18f4b3ffbafb116309ea204abee7f9366f4a5e95b2097721a56acc21b1b439e5794415e3cce785b44c34f03e170a46f4fae0120d024a021502718fc918c5330f57f7437dda833a1217f2b81f6237a646cc1f06fa43a97f1976a914584c05957f7310787447a5bbe45c051891cb573388ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a12000000000000000000000430100013a55eb185b48905b5698554c1ec1f9d786c3804aa54c4f60d1e9bace2fab2a9701d1530433f68709a102e31dc6ebd7974797552bf2ab9731368557ea5cd1dbd9fd4d0b6023000000000000000198e301b97f5fd678c9a26cf98080dde29edab47364cbd8c2cce7e793089d3636a8b250d8c590f4f10b6125c11b2594da21b869e573250c9d94dea60b32af6ec7ba3a37cbcc8484cc661e90c054c24cd741f4ac9c236ea40264fa662962fab18b5fe66096d345b24307277298dc3d19cfe5f93f043f963b5772eccb6710d28915e8b761210644ea706e336ad866761188e31f1a098c4c322ebc59a9420e71471611eb89f93381b5506f2bcb786572723e7a7b8cf1bab88e729c5d280fa6c606b87fbf2ec7a49d1a1bb4a69d5f6f95ebdb0eb5b8c234b8baccf4cb5716317b46008d687a648f7de084cf6314864624aeacde4844a921cd3e0c9f6d540b356913384566c7d26f5f6a82d9409dfe52f9fc762cc9639802a97d248673b37d7c6f18e6429240fe4a355ce623deee770ebc597264dfc63d63c2ad50cb283bdac335ae67c604ae9457f539fcd66151cdbeb55ffd467ba9c25587428a1fcb50c4e55c1aef815560eef6de7f3a54e8a779989de8892edeafe77720b8bd9d3551f9ddaa5143409545fce91ce2a78e7ca045da771e3660ff17c9ccfe276ea85355d98f0bc3ab41ddfe3428b3c1bc51b0b8f245781d9ae572c977f8ee23ad8aaed051659788de5397ac36a6e210fc21d79a915ee88d61fd2344f8cbd9f3f19cd1193cc6d9a0d9904746d41e4d7305e9a22a926e658388dc61ab8efd5b55df0b46aaf469239e0eaac56c051f608e3788c762f1a5d17a534e4a90fc1b036f034a720669e4ff13dd50253f8a72d6c69df72f05d8927a75abf9e19897fcabaf4e048aba0dcfd72ac60519d962d9749de89a5621790326ba7e897697dd71d1a50b6c31a8184ce1f00bf02c54cff866ce20adcd323350932587f165317fb9b70bcfe45a93618fc2dae97af3f7a515eb892e7c426465f828ff11a416298aa365dbac6cf227a01c5d1e65171640f55cbc7dcbc5f9b22e34ad504660a7fc110d6ecc2f5b998721ae326da3312d8003c03abb80e4bc1db81e3c2d99128ea3aff66fbd291ad45f1d74978f4bd24a86e97e7655adad144cbf033ba07cddcc6cf6a7263d3294aeab5c0ca51d5d770a04ea63a8ae4e72d1b52131b256c81e0429a61fecb64bdd58238599b32cf1ff51a0677ce852f12b85847cbc1b7e6ffbabcc6bbf20f36eb3e7118cf4536aeca269e995b071f1a8161d957023e35d7b13829048a8f85930b1a76e473724bf6a7621ee2160650965818755a9850fb5bdede69f0285ef88df3b2b4a370dd5b5c8ca71d171b9e72736724f20f55fe420669629a25d6c8eea06edfe0779307d2e8363cd9b2e6a25798ec693ff09d6167faa7ef34da8f361e54f09b33ee01efef5029a18a4ce823147f0b2982fe99824ae55cc00ae91be8eebab3ec3bcd024656374f0aea5841b1ce3d8e6032e088ec10e75c116300b312e0ffb61f76e674035808650bf0b0d05ce17cb1229eaf44c4a68260c496977d4c73569a81008e16f061748ca2141819401fd5821c9dd9433ca75ce5c8048b4e573e30f6aa5290966b54a1177dabf771129d21ab8e2f6d4e92696ed62f66ae19fe63a77bf2cd99bc6c04d81187b26e60f963149e9823c33c535b93c5e5f7bafd8144a52bd621498bc029a106be82aaeaefec9b746b6e245ae184e5c30c131b43907bb7d90d3455287131792b125a951ff637c45f18629c0e6d317253de75001620414953b2dac3706645d8376faabd8812c2bfcb9b38342d240a9a031c10f5c9a79c5683c861c3c6ab7a1c880f13ff45ab033d52ab05b1a81deb7cab2f562a1af0658cd6a36778904def3228b3d609cb4297b215e0972a198d049220546c4dba10e381360df25ee966bedf3349c9bff27bd61f246dbaad6eeec9178b3c107453d687af66a886f7bed92931f26a089c542d8d053961176f40d7e8d09a2e8f426099d64f4016810090496baf74c41aa3d3d94ef9b93e5af8f4c8a3bd23143ad80fe995dcc7717b4a15420d375076f1d0289a8ef74fb04b8a7dafc81f395eae4169310ca3e9c5095af62865154c7daf2698f5c23fbd40d540d8984e4dac90d55b2347650dea97cd200eb71669007328048aa398fa8ea2dda189c43dd7569f2aef7e53c556cc386dbdcb5a14abee4e31c4e52d0d70f31f324d449bd0346aeaa821572d004c3d401a05a30da66b791cf6ba8404b9e024489c2d461cd8da207b11c63c5fb4dc26fed7489376841cc6d682166f75d1968dad3eee160b96be520efb490b9ce2abb5e9446a3481d2ed50b76b91c19e07ffca4bb7d427e0002e3e057371f4940aa9b526af7d101e37a226aa75eefd23490d103d2e548e7883a7d349840ddd7e4a9fcf0e3b92fc33b91d82ce55d28ec19886852aa909e46addeed8ee60048ef346671bb27e355497031716d6c6e0f20cbf57b9249009720e2ca6efee2fa393232c8914630016fc4134f60a1cae3e80ecb7cef49514114e467c3d8ce4e521b0df60bbd4b0e29bf82623d2a0d294df6b95f31f917514f3496cf53224815ef8ccff2c286044e814ee00e940dd1a958c55cd47961744223dd0f0d0fb72f7387350a2e17fa10e115c19707351a8545bc19a90f49dc439d23b5a71d4ab96e6e476ee97fceaca6613e12a5aaac43f14ed66f11c93b0e5a89e3419f3daff03808e1954d6e488468ee455d2526c14ae261e83cd36f326c153d970fb9bfc211df58bd7cfbc6d50f79692c2a09b3095f23498104e17413f0cb7a404b96da40c5ba40a641a557b189804e36be19ed7eef55881e83f83e644172883aa5f03323b813c464a4e3fb313fcb3434ed6e1f5fbd717bc36fd13a0871ba04aa8dacdec17444115116420515facff7cedc284fd2bcbaf239be49331081b59b2c8da298dd0e58fdd72064b687960ef3aab67135be8cc457bf8cdb021a371c42a1387a317009934bad70e36b84d48d17440ac0ace767da75a5c74d6b0a52f6755c55ef0c57238d3e62386073a2c1914968474eed91306fef5a37ce39c09150f52c23767c76429c4b8f9523ce66a463b9b3284e44a1cb0e6130dd625815c7477305d09d237aed991cce5a142bbe69ec5c8bca3e502a2edf588ff6a855fb10509cb73210787e33945ffa199cccf4438c319e2b019716d1564e62e43cd6380cd72d323e31d61a93bcd4d4c77d2d68600e23505e336ff4bc13d10b128fe0aec943cd2e999923ccb35b9ad4d85d5ac41ccfbf6d9911fe4f90eebabc1cea675a75bc54ee43b6ff75ff6b132976239301e3aa79b625cedfa4172ecfc7fa69a96e9e9ac5018d94481767a27016e869eb858e86f3e11bc9c4770e6d784503b7b8d7d2d5fa8016e207bfa71eae63a424ce7a86c86dc737e866c13ab1819040d84742b3978da668de8304ee64b6b1271d1b2ded58c619a52a4a9a3683002a8a2f263cb7f734c28e8311a2e706dbff2221baf7b49b67f237f0b1a390ab480d96f29c41d01b807121ea2ab97a2a69378a52953f093c7b7d3dc584ec8ed7d00cdbb1eff3ede23278d610a2269f0991acc4b6cff1b31d7b397c92f52b481d57aa9346b138d8f8ddd8647240bc2addb32d46fbad8eefe2231f4c305c797fe3c4ba560a71a6aba8285f8d433105d9031ef38ab019d7bc4706778168a790b0a77f9c7350de1189798a37e56a6975abe16fb2e1fb945545e61e3366e0eb5571ded3a189fd3e35e9f514f4cffb3606d4a58cdeaa776775e71fea4f76810eb3df7a8ee2ee848cd1d6a21b2dd5e77621f455924e3e01d3092a16fd29c13ad414e2f9af61c43684395f2c4004e87cd77f564fd849e7cb389107a75cc0ad1da30d446056b4058d70388a6e69abcbf95fa1e6437c67a4c14cbd3c5654dd4ce2344c37d162ea45a12915878a4f04317898af69f223588c73a62dead572422b2da46adc657ec2a04127ab90db71f17b7a6e4cb5574c90bc59b7ab381d7e5b86d98c9952eaae19c1b70794f49e1da552aefa31b7b21b8435f0f90040341b16bc9e69d2a1f326f7ae1de073064c9980b664a8ef7bc020cec79ef015473750cab5cf5f8e2647c42f90177294fc0771c1ac1d87734eecf325ff8b51b414fb3fe7771371a4ccee45f50000", "txin":{"txid":"5d4623a46ab9e77f7a5cbce90eb5f8eae44974d70cd5b81e49701c6099fa7931", "vout":1, "keyData":{"hex":"021b35e12da3703e4b5dd0ba636675bb7c2e2431a660c44b145b0f38e7e1523da1","type":"pubkey"}, "confidentialValueCommitment":"097721a56acc21b1b439e5794415e3cce785b44c34f03e170a46f4fae0120d024a", "hashType":"p2wpkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"sighash":"fcbaeb96a9aee9d7f0c30610239dbb12d3bc2bcaa255b4dcbeffc04b906a5896"}',
  ),
];

const elementsErrorCase = [
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(Txid is not found)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"5d4623a46ab9e77f7a5cbce90eb5f8eae44974d70cd5b81e49701c6099fa7931", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(Txid is empty)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(Txid is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"ef51e1", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(TxHex is empty)',
    CreateElementsSignatureHash,
    ['{"tx":"", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"transaction data invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(TxHex is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"transaction data invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(pubkey is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab11","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid Pubkey data."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(pubkey is empty)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid Pubkey data."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(amount is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":-1, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Amount out of range."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(hashType is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"aaa", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hashtype_str. hashtype_str must be \\"p2pkh\\" or \\"p2sh\\" or \\"p2wpkh\\" or \\"p2wsh\\"."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(sighashType is invalid)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"aaaa", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(txHex is not hex string)',
    CreateElementsSignatureHash,
    ['{"tx":"zzzz02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"transaction data invalid."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(txid is not hex string)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"zzd3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(scriptHex is not hex string)',
    CreateElementsSignatureHash,
    ['{"tx":"020000000001270aea6f10688daf5d2da51b753fe2a6358d4f290b5e025903b4ce54c90f29e80100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe003c16a227c5c4d4b4682b71ee7cb809102cd8955b888757695898ea994bf74ee711976a914b3c03c18599d13a481d1eb8a0ac2cc156564b4c688ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"e8290fc954ceb40359025e0b294f8d35a6e23f751ba52d5daf8d68106fea0a27", "vout":1, "keyData":{"hex":"zz52210218edb5891db05091053f65d3d346d093542dd5c149bed83774d7ec2463613440210214f7f9c556eba0e45a1ef4da90d2df79f670715cdb027a44f5f376e17e5e591c52ae","type":"redeem_script"}, "amount":100000000, "hashType":"p2sh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(pubkeyHex is not hex string)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"zz0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "amount":100000000, "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
  TestHelper.createElementsTestCase(
    'CreateElementsSignatureHash Error(invalid confidentialValueCommitment)',
    CreateElementsSignatureHash,
    ['{"tx":"02000000000109c4149d4e59119f2b11b3e160b02694bc4ecbf56f6de4ab587128f86bf4e7d30000000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f010000000005ee3fe00374eb131b54a7b528e5449b3827bcaa5069c259346810f20cf9079bd17b32fe481976a914d753351535a2a55f33ab39bbd6c70a55d46904e788ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000007a120000000000000", "txin":{"txid":"d3e7f46bf8287158abe46d6ff5cb4ebc9426b060e1b3112b9f11594e9d14c409", "vout":0, "keyData":{"hex":"0248ce4ad37c47bae7c827f1631645ab1198206aafd9708b733a775dc9ee4e3a48","type":"pubkey"}, "confidentialValueCommitment":"096c711e318b1b540f683aa3ed570c571", "hashType":"p2pkh", "sighashType":"all", "sighashAnyoneCanPay":false}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}',
  ),
];

TestHelper.doTest('CreateSignatureHashElements on Elements', elementsTestCase);
TestHelper.doTest('CreateSignatureHashElements ErrorCase on Elements', elementsErrorCase);

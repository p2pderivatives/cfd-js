const {AddMultisigSign} = require('../cfdjs_raw_module');
const TestHelper = require('./TestHelper');

const testCase = [
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign 1',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262030004111111114752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign 2',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"},{"hex":"22222222","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620400041111111104222222224752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign derEncode true',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","type":"sign","derEncode":true,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620300473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb014752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign derEncode false',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"3044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01","type":"sign","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620300473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb014752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty sign hex (derEncode: false)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c63296049032620300004752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign maximum (sign count: 15)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false},{"hex":"22222222","derEncode":false},{"hex":"33333333","derEncode":false},{"hex":"44444444","derEncode":false},{"hex":"55555555","derEncode":false},{"hex":"66666666","derEncode":false},{"hex":"77777777","derEncode":false},{"hex":"88888888","derEncode":false},{"hex":"99999999","derEncode":false},{"hex":"aaaaaaaa","derEncode":false},{"hex":"bbbbbbbb","derEncode":false},{"hex":"cccccccc","derEncode":false},{"hex":"dddddddd","derEncode":false},{"hex":"eeeeeeee","derEncode":false},{"hex":"ffffffff","derEncode":false}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262110004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04ffffffff4752210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey (sign count: 15, non-segwit 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"eeeeeeee","derEncode":false,"relatedPubkey":"0257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"dddddddd","derEncode":false,"relatedPubkey":"03b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0"},{"hex":"ffffffff","derEncode":false,"relatedPubkey":"0254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"}],"redeemScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2sh"}}'],
    '{"hex":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea00000000fd50020004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04ffffffff4d01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5faeffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey and no related pubkey (sign count: 15, non-segwit 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"},{"hex":"dddddddd","derEncode":false},{"hex":"eeeeeeee","derEncode":false},{"hex":"ffffffff","derEncode":false}],"redeemScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2sh"}}'],
    '{"hex":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea00000000fd50020004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04ffffffff4d01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5faeffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey (sign count: 15, segwit 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"eeeeeeee","derEncode":false,"relatedPubkey":"0257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"dddddddd","derEncode":false,"relatedPubkey":"03b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0"},{"hex":"ffffffff","derEncode":false,"relatedPubkey":"0254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"}],"witnessScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262110004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04fffffffffd01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey and no related pubkey (sign count: 15, segwit 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"},{"hex":"dddddddd","derEncode":false},{"hex":"eeeeeeee","derEncode":false},{"hex":"ffffffff","derEncode":false}],"witnessScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262110004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04fffffffffd01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey (sign count: 15, p2sh-p2wsh 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"eeeeeeee","derEncode":false,"relatedPubkey":"0257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"dddddddd","derEncode":false,"relatedPubkey":"03b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0"},{"hex":"ffffffff","derEncode":false,"relatedPubkey":"0254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"}],"redeemScript":"00205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5","witnessScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2sh-p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea00000000232200205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262110004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04fffffffffd01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae00000000"}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign with related pubkey and no related pubkey (sign count: 15, p2sh-p2wsh 10-of-15 multisig)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"02cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"0336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e"},{"hex":"44444444","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"},{"hex":"33333333","derEncode":false,"relatedPubkey":"03311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a61"},{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"88888888","derEncode":false,"relatedPubkey":"024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf5"},{"hex":"bbbbbbbb","derEncode":false,"relatedPubkey":"023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a550179"},{"hex":"cccccccc","derEncode":false,"relatedPubkey":"023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf05086"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"},{"hex":"99999999","derEncode":false,"relatedPubkey":"02624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62"},{"hex":"66666666","derEncode":false,"relatedPubkey":"030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9"},{"hex":"77777777","derEncode":false,"relatedPubkey":"0300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec3"},{"hex":"dddddddd","derEncode":false},{"hex":"eeeeeeee","derEncode":false},{"hex":"ffffffff","derEncode":false}],"redeemScript":"00205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5","witnessScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2sh-p2wsh"}}'],
    '{"hex":"020000000001014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea00000000232200205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c6329604903262110004111111110422222222043333333304444444440455555555046666666604777777770488888888049999999904aaaaaaaa04bbbbbbbb04cccccccc04dddddddd04eeeeeeee04fffffffffd01025a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae00000000"}'
  ),
  TestHelper.createElementsTestCase(
    'AddMultisigSign AddMultisigSign sign with related pubkey (sign count: 2, non-segwit 2-of-3 multisig) isElements-true blinded',
    AddMultisigSign,
    ['{"tx":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f80100000000ffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000000430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000","txin":{"txid":"f8f455430f7c8e9a378b516e7ac068bfe304f51c88c241c5aab9c226385d0bdf","vout":1,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"03ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba806"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"03847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372"}],"redeemScript":"522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53ae","hashType":"p2sh"},"isElements":true}'],
    '{"hex":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f8010000007600045555555504aaaaaaaa4c69522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53aeffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000000430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000"}'
  ),
  TestHelper.createElementsTestCase(
    'AddMultisigSign AddMultisigSign sign with related pubkey (sign count: 2, p2sh-p2wsh 2-of-3 multisig) isElements-true blinded',
    AddMultisigSign,
    ['{"tx":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f80100000000ffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000000430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000","txin":{"txid":"f8f455430f7c8e9a378b516e7ac068bfe304f51c88c241c5aab9c226385d0bdf","vout":1,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"03ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba806"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"03847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372"}],"redeemScript":"00205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5","witnessScript":"522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53ae","hashType":"p2sh-p2wsh"},"isElements":true}'],
    '{"hex":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f801000000232200205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5ffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000400045555555504aaaaaaaa69522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53ae00430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000"}'
  ),
  TestHelper.createElementsTestCase(
    'AddMultisigSign AddMultisigSign sign with related pubkey (sign count: 2, p2wsh 2-of-3 multisig) isElements-true blinded',
    AddMultisigSign,
    ['{"tx":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f80100000000ffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000000430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000","txin":{"txid":"f8f455430f7c8e9a378b516e7ac068bfe304f51c88c241c5aab9c226385d0bdf","vout":1,"signParams":[{"hex":"55555555","derEncode":false,"relatedPubkey":"03ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba806"},{"hex":"aaaaaaaa","derEncode":false,"relatedPubkey":"03847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372"}],"witnessScript":"522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53ae","hashType":"p2wsh"},"isElements":true}'],
    '{"hex":"020000000101df0b5d3826c2b9aac541c2881cf504e3bf68c07a6e518b379a8e7c0f4355f4f80100000000ffffffff020b296c96d43652ad579813036e211c95264fb2766628a0d2f52cc227d6dcc7aa4508bf04428a86a4b0cd15371928eece02865e4be0c589279cd98a18671f41507ebe0305f29a71e0419fc4e9b49f297f4255d709e947a19cc00d997ee039ed57015da51976a914be3b1c46291053c2a66991395e146fd95de71e0988ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f01000000000098968000000000000000000400045555555504aaaaaaaa69522103ebb413d0982683d4c620f713a1e574da608808bb09311bc15420514ccb8ba8062103847c6910d3fa33c213dad4d14dcb46234b744f36030a0e2c737009e516d52372210359afbbd91f06c905ee26dbf94774496f944f2a48e33a96b3d3bd90a8c60820ce53ae00430100013af821d2f93aaf2694b24ee51f59e8b8c76274d8ff8cfa49ae206057a9a05cc0e41408136b6633950b5f896a066af2cd7e6b5d66de222c2ff791460c4945fcb9fd4d0b602300000000000000017b3b01ef4a4faeae7c0bd888f91de193e92acda715d44468b499de2f28b6f6c236a90dba16fae3820b766d1f359acfab7ce4648af71c071466d219db6c01207ceb8c875932d0a0aff76f63da34274877bda1c67cd87249938a10ad5e0ef8a853f873739d2f04aa13959f6baa0114569bfb117179627bf6a5a56e9de3822fd4e1e4e3244d5fd45f34c47416cb7674717e90c6e810586b50a2a51bb2e36b5204064a2e5d299f4aaefbb5ca2b02b7f1a14bc9e176314a595f85045ad27a6d5be2c88c4ffb34d8556aa45776dc3a1496a7e7a0853965a47f3cce4d604139c52389be4b64ffe70cc38247618ed6d0143023bef80fddf947f2f803fb0006f90e48a0daf8698c24470e2ba3c0d9127805178aefe246b2b72c17e5fdfb21ad9030fbb2536caa0b47bbe6ec17448f86a0e78ba4b11d1a0b4261016de2112c1e7aacaea65fa451821289a519d59d140470cceee6bc44fc43d9389181b134afe9aedc04378622442fce1a82b7046d93f5712a946bd99f47ee4c5a68af85356af158a9d1c647118399ec963b65de56c51d4d02f2cbf9b1dab86cd17c493b2c85f9d7572cfaca0868f9a47e2f24804459d2d0b304ac36d4f9424b88b8bea5869367ed7363fb95d2f20bedfe39364f8e543e2500cdaa8811d9177e6044b0dfaee03fc7458af29e8fd1e5b3a7181ec69c9c4043163a16aea45d1267e980a30cf0e1f9bcc64b3da6728eeba4110341fdbba22a46744bb9aa2f01bf2878deb1ae8f1dad8004f88373c15f28bcd6f30a9e67ff1b4efc5b34f9cba88cb53bc7a4d4e5c50534def502fd55db8b51dd1b3f5dd6f56f530fc29fc49a0bb182e033aa21d7df5e1aa48b3b1308bb9b9e67221e471520ad9822e82a2ec94244b3e488b4bfc10055e559ba5b7038c1d61fa3cf4cc2a700545110ec79f10de75a73b0b4f81f055eb1352f70fbfaf80b111b17ddc44f4ca33b9e23ffeab82e738d65259356cc59e96bf1ada16c370055b2b9033ab27dd278e44d71672a445d3641a49b47a45bc6cc7c9fabc195d36d082e67631284191558892e9ac8cb79711f98acf6a25d789261679f3eb381a5ade1747f7d083687a18999dc96c0f1dea1d9effe426987cf844d09437a86f8b252ab4ebbe0dadea0fe7cd388e8d123511826f2eef9753d4141329ea1f64d145db9a6beccfca3e150b7c3360681496fe9dbf18b8b4def52b1c94d5e342643ecd8e0495813ec16a8ab212f53b751ff5e59fc209901ad116445b3c528408e1cd3dc0025eec527aa2233b561ce4718aa1bc5ecfe42821c6951a40b666a8685d5394118dbab6d9e7deef3a49f3cb182e3ba52510bae0ef827854a84f74453ce217066744b4f98ea0175b0fc1a1c24725a2749b244c920b5af23d37688f761bd9618c4ce2c2e015de9f1ad2e4fe76cbaf0ffe99f39eb9b38e6e8858d0b00dadb778e0ff2ba8540cd6528df0fcd7e0a3c5a7c7ffdb439e1b7945e76d11c4fa50b38bd79d4eaf58e6d8fe14d4a325e8c72ddd2ed024bb9f9209a8c23abda2a29a06ea85035345c3ba3d5b8cf3ff14c5409411a997958c81ba235fe796b3f139524c7ba983778c011b8c62afef0b5e0963911ee4bf247642fc3851511fe27aaddd3b4e17d1badbbf57e77fc561fae720e390c13d4507211b6dc5e3d918a9b5ab1e4c3cf77a0f1d5fc3ba175ff6e851490d545b7b03b806508091c9ccf60859daa3b668a49aecedb9f45c83d0270660baa38107ddef8095d29876cf119178eb4b41f715f1008e0d99a2150bccd523cf0c3ecf166067f9584a8685140c7e1a99444119a0b9df5f9ee80e920aeefa57c2768d98a24eb4ca4ee9e095ee270922a12139515e289f078c451a4dda14d0a0554d9b41cdc37f37f7c78040ee1cae52dd333b77f65416fe0ecfd5e4c620b3dc145b9360e1aabc723219db7d39a1d0d344baf7797a793b7ae6abea03b02041608e6491103f960e151a8bea7dd8ccb9d8882084f2dbc5cc2f19625398a3d14f5fcd503a11b287a61e26ab0d7cc2d9c4f5617a15bbc77cb4338e30a541abaa81fe00fad640d01ced14bcfa66d9a333d7e03a9ad132d08eeb4f066432bd71e2d7ebbca5df094ae22566dda46e77f2b653d04bfad4cdac9e1a1f3a7020de6551fa72c0a7da742a37425d07bd9ca532fa05f813fae042cf71aa18767cb93ce89fff0a8cb662aa7a559bb7e4e0a79e346e9c2ecada863da7f29e10d56e8c5b04c2b5119c4e8205ede7548d54b6520980982b3d30a865b76b2e75df5adcbf795fb6e3993063517f493692d83beb3bb6485caf7f9a785c104665967a2bb2cca5d61143351afb5fcd59d3340de375f4105a7dce26ff06c2d3e5841d3dc2e79738d9637f7b77578690fa4d55e8737dc46e697e8c07ed7bfd1a91cb8e98970e9254131bc90f4f03603b7f81c9cdf2e44e55d636d28a2328916562d31ddb08a458ed8a4fe4b187c3374b287b45a8baf92839efa569b695d2cdcd881eb9fd8f6151473bb94c1f2ea8b843e3505b0f16bbd762cbd1ea30b75748025fdb16a70061a572029a38131092a4242189b6c78803a29063a031f2a942315d98b05d26229d622c3fbc554e678094a8d8fede8d3bab1de8f9604d30b810c1ea79fc19dc41760cadce2330aa66d48c4b84cb6b0e76f9ca132d348b9cc34577402772edd70a290e1342b1188548c049b3e444b59eeab056605f7a2a57629dde42206f97decc86e4eef1dbea53745c0e54a2b7222c2bf4323a2501a20d422431732ba82f9cea0fe0e37cda27b06542adb5861350f37522e33ebf4cbadb18f3d24a75fe6113aa03d2dbc469598d2e18721a1475a2bdddba47e5ac23e7bae79094b348fb76d367841f048383f45180bdd4c97857019d49c423f053b99a3e20e494cfc049d8549b135918667ce5eb2cf158bbbd6822f638604ab037177ec8a933bdf31cdaae69eb01c835f4dff9d5c76b0d1530396cebbe5bdebbcc5ba03af38bdf80b881f97b7d320fad553f9dba2e450e8fbe861756374da9f2bde7138f9c1b55144e50d3de5066e2280ab9aff99b8fa9c77973b3af1fb3feb4f0ba4145e08dd91387b9f2d7d337e23443c90042b10f1293e7b73cd6768bfbd78bd65959c68b8b638d59787b6aec94859f8dd0b98f4cabce11d1a9ea5a05d63586854d79005f7de7e43a519226862d0f0cbb9dcbbf34b35dd2717f25c8138676d4e33907bd78f7bd04198f8f2f37a91e8425407d29715d36691fd3e925419c895cd16477532cc1fb727b24511c0750af6526cf95aec4e61d185b0ce8ea9c68cd29c1c257b87d5f0876d2abca0ea66576c1fc159f49f0a7114aac2a9a719aaabef5b4190cb06f5425614c2db18f67d2a16524853be4e4316efa1fc915981c3cbd574eb32ff5a41781b34230a37769bbe6de63361b042e2aa73b791a4a8416bdbe588f9776a6bbc3d9a2e05b0f3ecb8bd94b6758f0116cfca60d9fe6c096cea5c943e7b15412f259176b65cb6391daef8f1bb583791c695d81d9fd92044f303342d2b856363fc1ebea5ae3ea7b7a3ee75d480cddb0382f9c9afa199e0744b1cfa93583dced376d5e6180cc8bbcbbe5c9ebe422018259b39ae4fdcc75f57256969a621f20290581b558c950004fb5e03b5280f224048cee5453f260fdcdb940d358a93cb9caaa3a6ddd40d7b1bf347de29998244045c05953177230617126c4ceeeb0097434f061281c524043930036814db40862a1377823a00a482a75de99f4b916261deaf338e99e91be5829314f3bf01da41d8c019e9870e9fbb8011dc3dc85964a1f9c60d4ccfd5eee31bd90969f9741f1514d53cdb9a42eab1e3399a35fa65dfdbee50e360fd403dece39b85ef20f196c491e6e4b71f51bc9b16a44bcae447cb4ea4ac27801837168a996363e25e67c9a2ca6eac2565e47245acb4e2761043fbed1f9764bd4825fef439bb29af092a5b4863a57df3ff114fa574ef662dfde6d4a1fe7c0acd897d5fadf6a23543bfb19ba462d6725ed8e472e1717da4de05714e0215ceffe7b69947fa93c2a66893e4760aa68f0c0167212d77b626c71157dfae7bc269e4fb665571b03deccd0000"}'
  ),
];

const errorCase = [
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty hex string',
    AddMultisigSign,
    ['{"tx":"","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty txHex."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign invalid hex string(3 chars)',
    AddMultisigSign,
    ['{"tx":"000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty txid string',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign invalid txid string (20 chars)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d16730","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid size Invalid."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign txid not found',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4d","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign append signature to invalid txin(vout: -1)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":-1,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Json value convert error. Value out of range."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign append signature to invalid txin(vout: 1)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":1,"signParams":[{"hex":"11111111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Txid is not found."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign empty',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"sign":[],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid array length. empty signParams."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty sign hex (derEncode: true)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"","derEncode":true,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty sign data."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign invalid sign hex (3 chars)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"111","derEncode":false,"sighashType":"all"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"hex to byte convert error."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty sign sighashType',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":""}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign invalid sign sighashType',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"abcde"}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid sighashType. sighashType must be \\"all, none, single\\"."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty redeemScript (hashType: p2sh)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"all"}],"redeemScript":"","hashType":"p2sh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty redeemScript."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty witnessScript (hashType: segwit)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"all"}],"witnessScript":"","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty witnessScript."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty redeemScript and witnessScript (hashType: p2sh-p2wsh)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"all"}],"redeemScript":"","witnessScript":"","hashType":"p2sh-p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty redeemScript."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty redeemScript (hashType: p2sh-p2wsh)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"all"}],"redeemScript":"","witnessScript":"5a2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a612102158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f91163342102cb839b30751233637d21c2a1f12c09f8183d3f6dc97d1bfc0ed3d787499de39f21030a6324abc47e046efe98841773bad9aab843a177d9dcfdf06f8132ab97e785c9210300d6d0ee236deb0257c5e337b0192cdaec944eb5e83d34a305cd8bbfc62bbec321024c062ac5aab7f754e134385aa31c8de55b5414d613ede69484f30e4ef6e70cf52102624f62bc972674029a6d9f207dc8ccf4ffb58b6faafc352619142fd98bf46c62210336f92fc6f5470c13229fb59facba5b040285a11b3040d1ba4cd69e1ff58a3b9e21023765bb0b30563a53508f36495f639ce664f24b0b518e0451d5dc7dec6a55017921023b02f8b116398f14981f97b4118baa5c72dc9973031529569e54a588caf050862103b44f76723b1e1c8af9d48e3f7478364781c5f97aececaa27e3cc0970c546a2f0210257feca779a4bf12e6737695dccdc7c381535e5243c440830b5f722e0f9d32be8210254abd0c9feaf82fc04bdc9d0e6523d87230cd7f7b57d173b58e2019f77fd201a5fae","hashType":"p2sh-p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty redeemScript."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign empty witnessScript (hashType: p2sh-p2wsh)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"47ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb","derEncode":true,"sighashType":"all"}],"redeemScript":"00205a265289859d2062ca737d5c38066badf381e2177a30ea1da28e932586bc0aa5","witnessScript":"","hashType":"p2sh-p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid hex string. empty witnessScript."}}'
  ),
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign sign maximum over (sign count: 16)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false},{"hex":"22222222","derEncode":false},{"hex":"33333333","derEncode":false},{"hex":"44444444","derEncode":false},{"hex":"55555555","derEncode":false},{"hex":"66666666","derEncode":false},{"hex":"77777777","derEncode":false},{"hex":"88888888","derEncode":false},{"hex":"99999999","derEncode":false},{"hex":"aaaaaaaa","derEncode":false},{"hex":"bbbbbbbb","derEncode":false},{"hex":"cccccccc","derEncode":false},{"hex":"dddddddd","derEncode":false},{"hex":"eeeeeeee","derEncode":false},{"hex":"ffffffff","derEncode":false},{"hex":"10101010","derEncode":false}],"witnessScript":"52210205ffcdde75f262d66ada3dd877c7471f8f8ee9ee24d917c3e18d01cee458bafe2102be61f4350b4ae7544f99649a917f48ba16cf48c983ac1599774958d88ad17ec552ae","hashType":"p2wsh"}}'],
    '{"error":{"code":3,"type":"out_of_range","message":"Value out of range. sign array length over."}}'
  ),
  // OP_2 <pubkey 1> <pubkey 2> <pubkey 3> OP_3
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign Invalid Script(OP_MULTISIG not found in redeemScript)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"}],"witnessScript":"522103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a6153","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"OP_CHCKMULTISIG(OP_CHECKMULTISIGVERIFY) not found in redeem script."}}'
  ),
  // OP_2 <pubkey 1> <pubkey 2> <pubkey 3> OP_3 OP_EQUAL OP_CHECKMULTISIG
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign Invalid Script(OP_M pubkey contain num not found in redeemScript)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"}],"witnessScript":"522103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a615387ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid OP_CHCKMULTISIG(OP_CHECKMULTISIGVERIFY) input in redeem script. Missing contain pubkey number."}}'
  ),
  // OP_2 <pubkey 1> <pubkey 2> <number(9000)> OP_3 OP_CHECKMULTISIG
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign Invalid Script(not binary data input in redeemScript)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"}],"witnessScript":"522103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c02900053ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid ScriptElementType.(not binary)"}}'
  ),
  // <pubkey 1> <pubkey 2> <pubkey 3> OP_3 OP_CHECKMULTISIG
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign Invalid Script(OP_N require sig num not found in redeemScript)',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"22222222","derEncode":false,"relatedPubkey":"033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c"}],"witnessScript":"2103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a6153ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Invalid OP_CHCKMULTISIG(OP_CHECKMULTISIGVERIFY) input in redeem script. Missing require signature number."}}'
  ),
  // 2nd pubkey is not contain script
  TestHelper.createBitcoinTestCase(
    'AddMultisigSign related pubkey is missing in redeemScript',
    AddMultisigSign,
    ['{"tx":"02000000014cdeada737db97af334f0fa4e87432d6068759eea65a3067d1f14a979e5a9dea0000000000ffffffff0101000000000000002200201863143c14c5166804bd19203356da136c985678cd4d27a1b8c632960490326200000000","txin":{"txid":"ea9d5a9e974af1d167305aa6ee598706d63274e8a40f4f33af97db37a7adde4c","vout":0,"signParams":[{"hex":"11111111","derEncode":false,"relatedPubkey":"03d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b7"},{"hex":"22222222","derEncode":false,"relatedPubkey":"02158acb215ab8d1ec30e17a98824e0f443f70b8d90bf5b9c6ef3d1076f9116334"}],"witnessScript":"522103d21dcddc09b0d3e831f3d8a435f1d0221fe738d2232cf67af9e0f40ce10059b721033778f8983c89143a6c12c31b4662bfb69eb9d31ae4d18f4b9c7e3da502be467c2103311266f4d7ca742ca096ccdd341293bf769b41e8b5f7ea6a8855d154106c1a6153ae","hashType":"p2wsh"}}'],
    '{"error":{"code":1,"type":"illegal_argument","message":"Missing related pubkey in script. Check your signature and pubkey pair."}}'
  ),
];

TestHelper.doTest('AddMultisigSign', testCase);
TestHelper.doTest('AddMultisigSign ErrorCase', errorCase);

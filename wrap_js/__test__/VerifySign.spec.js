const {VerifySign} = require('../cfdjs_raw_module');
const TestHelper = require('./TestHelper');

// テストベクター参考（https://techmedia-think.hatenablog.com/entry/2016/07/08/153449）
const testCase = [
  TestHelper.createBitcoinTestCase(
    'VerifySign HashType(P2WPKH)',
    VerifySign,
    ['{"tx":"020000000001019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b580000000000ffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac0247304402200aecb70a0dfff96a088c6cd60dc5905e8117f5e68e9009de0e45a87fe5f6bdc402204188555d295daaf309716ca2372bb9d9cc778105fe87de50f5a9ccc352acf314012103f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d600000000","isElements":false,"txins":[{"txid":"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c", "vout":0, "address":"", "amount":1000000, "descriptor":"wpkh(03f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d6)"}]}'],
    '{"success":true,\"failTxins\":[]}',
  ),
  TestHelper.createBitcoinTestCase(
    'VerifySign missing signature',
    VerifySign,
    ['{"tx":"020000000001019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b580000000000ffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac0247304402200aecb70a0dfff96a088c6cd60dc5905e8117f5e68e9009de0e45a87fe5f6bdc402204188555d295daaf309716ca2372bb9d9cc778105fe87de50f5a9ccc352acf314012103f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d600000000","isElements":false,"txins":[{"txid":"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c", "vout":0, "address":"", "amount":2000000, "descriptor":"wpkh(03f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d6)"}]}'],
    '{"success":false,\"failTxins\":[{\"txid\":\"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c\",\"vout\":0,\"reason\":\"Verify signature fail.\"}]}',
  ),
  TestHelper.createBitcoinTestCase(
    'VerifySign missing pubkey',
    VerifySign,
    ['{"tx":"020000000001019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b580000000000ffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac0247304402200aecb70a0dfff96a088c6cd60dc5905e8117f5e68e9009de0e45a87fe5f6bdc402204188555d295daaf309716ca2372bb9d9cc778105fe87de50f5a9ccc352acf314012103f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d600000000","isElements":false,"txins":[{"txid":"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c", "vout":0, "address":"", "amount":1000000, "descriptor":"wpkh(02fd54c734e48c544c3c3ad1aab0607f896eb95e23e7058b174a580826a7940ad8)"}]}'],
    '{"success":false,\"failTxins\":[{\"txid\":\"587bc524964147ced22d5bac41de55504e7eeb9a795b34aa0a5318612acb539c\",\"vout\":0,\"reason\":\"Unmatch locking script.\"}]}',
  ),
  TestHelper.createElementsTestCase(
    'VerifySign HashType(P2WPKH) Elements',
    VerifySign,
    ['{"tx":"020000000101319bff5f4311e6255ecf4dd472650a6ef85fde7d11cd10d3e6ba5974174aeb560100000000ffffffff0201f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000bd2cc1584c002deb65cc52301e1622f482a2f588b9800d2b8386ffabf74d6b2d73d17503a2f921976a9146a98a3f2935718df72518c00768ec67c589e0b2888ac01f38611eb688e6fcd06f25e2faf52b9f98364dc14c379ab085f1b57d56b4b1a6f0100000000004c4b40000000000000000002473044022045792f51da8d092f237d6f06aacfdf22c7398a2a0db68c7a3cd1ee05aa728b240220486477ec0560de88000855d7e9ea90fcae3808e37f32b6389663e2c8cf3db604012103f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d60000000000", "isElements": true, "txins":[{"txid":"56eb4a177459bae6d310cd117dde5ff86e0a6572d44dcf5e25e611435fff9b31", "vout":1, "address":"", "amount":0, "descriptor":"wpkh(03f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d6)"}]}'],
    '{"success":true,\"failTxins\":[]}',
  ),
  TestHelper.createElementsTestCase(
    'VerifySign missing pubkey Elements',
    VerifySign,
    ['{"tx":"020000000103564f093ef3f31cd268a8489ca927f96813d4f1a860fe88644e984912697daa8a0100000000ffffffffcfccb9da664ce180c41e904a6200a92e5a8457e134910ffa9ddd99c8c37c302d0000000000ffffffffe4cc814af5b1e86966ecdc99e9ccebf9c6ed1976ac6ecdc2c6a52ee9ead6484a0100000000ffffffff040bc2d608b1e3e822e966e20407cbd0991a296b7305013a3d41b399368a1f1149af09175a8b328c9e80f7458cac99227b176492a7e76c98e6f62e4137eed36718e7c103e84c58d6108c6e78dd7990dcc24d60fcf287cf3282dd8a30934d73118f4cc418220020991049dc37a98a0e03da9167a36e4aaedfde020d5331cf7b394f7060ca01c81c0ba5d62d41c3263d1363ce96e4ba78242e5f1cea777743dcd60e9f8a6f2603cab70991fbad5c63042f8200007262f6282b8a6ea2ba570e745911f3b5ee5dac6482f403c87352825b581e610986c12590bb13846f4c54d436e642cfe005af5387f3cd4e22002080dafc20603d1e188a89eac7be8818ac5831dced2a558f2a4e73790b83ba8e550a44521d106bec818660a9ca8e604a4a755318c58025c157174d7c5b2d9f000d0b0887291bd3b1d46d67878051a03bbf1a05aba0f5bdecdff16c7a27eaf5ad4c55f903e9b55e29f355b1e230d7b674032a8f135f0690e0c5fe04a50754e17315c263d3220020a206a457180384fd5bee2a7ef2d0642b27948390f902b7094a4110575be9c0940125b251070e29ca19043cf33ccd7324e2ddab03ecc4ae0b5e77c4fc0e5cf6c95a01000000000000138800000000000000000400473044022003aa101ad83919edc5e1178c9a30df6a9146b2229663b387860b72b2fda4d42202204ba4e44e7c9b66015cd4b8d3f27de7195aab7be98fc3cf949f557e5a0b00a8ed01473044022076050536ec34f5f93b2ba0302bd0e96879ea29d37af7a203eb8af978d7098cb802203ab1644f04575e2c5e9f957b36a51c6baace5e4f16e34c30e83de1efc419dab70169522102f1a5e75580f6c53aa8f223801296195792ad6ff5dbf1dfc0ba96d5522875620c21033d62b96bca95840a3a89a861ac0a6850c2389f4a78a300018b157e45a89480332103c05c228038c244a82b7584043ccfc59807e4e8e4d84d726e098ce71a0fceb57b53ae0000000400483045022100be67f6fff0de9484b8eaa21bb5ae96c8fc2a1e90d8326917cc09937c5815d5d302201d1e6751c24395e2b9d0e05883909f587bbee2313e76913472d1ca89c4f36cea0147304402201f8845d04becd73359357374aa175ff4575452eb2b86eef724ccb3b557d985ab02207d47f344a43a51f5c9258eb19db8c79aad491ba0fc201ec553a38396f5a44dc80169522103159f6ea0c32bd50173460b0ff3a26b34c5beaba0f982235a5645a28caea2d13321033d62b96bca95840a3a89a861ac0a6850c2389f4a78a300018b157e45a89480332103c05c228038c244a82b7584043ccfc59807e4e8e4d84d726e098ce71a0fceb57b53ae000000030046304302203ea3b5a4f8f8a6c94164433c92ab256cbe11d94e2d8d9fe029f4b4f54bb46bcd021f2268604869ceef5caea7593fe13dc3dd2f81878e4dea43c8756dad901f3191012551210324ab7a32fbe6d27c0de57c82c4e970f4edb57262e06b0f5ba9feaf2470c68e1751ae0083030007b364febd5a38754da1a454487fe0cbc92698a68ad887a15ea276492e1358077c12d758ac811cddd0ea82197ae96fe50f864739c38475e7338f6f550e9c91f27be186d75689a4a11a6abab605336f07ee272fa4fda8c321aa19066ae513d65269f2619fd9c4fdc98459737efe488e2823a13d4a6091be8eedc2e380b7a4d86df2fd4d0b60230000000000000001ecc801e2db7ff305fb57a72a2f001d32312ae15231e1ccb86d39204f504760c2bbe6535d5c1379df946acd6102521a14fb2f9cac2542ab28e02e4dc1d4a5b98ee371b4da82081bbe7d43ebc255fb59c3126566c3408b57af68ea59f0ad5147a2a2eade30d24d3e617e4cbd7022a9085d8fb4de5210f25bcfa8f925cc01274f74a5a2c908ac3e91d4b9c449671590712d6a79e0608fd24d07d534ff2abe21fd045bbe6311239b3e2fdf2cd3f761b043d5a72bf7b4621ac8862877be0300670384c52752bd1d2af192779740097b5a9955a70b604e8e8d6e9f90deb8065e836012ef00028df81b2978489cd48aa13abeba93a58e053c6fa350d17891f0375b463e18ea1280cafbd1ac7e3df7cb998ce525d0b24762c844a6b801cf520d3e95c96105c21c17f5ca96e4aa92cc6b3425f4636aec277440c21834cd18ee1893e8371218202f4a35e3e1dee8bb16a241dbc9755407fbeee33b75d28b4bb95d20ffe73b805bbe6cf6358ca86f69cfec0263d8aca03a04257f26fa536614f9680f072a19c0ba522b421f53e23d154e4c02cc2d683a59474be2d563f7d9a99b21db8227c71f9c0193a6f5ff02c589c2377908706528ec19fe8a683a8b514cc03217a8c5875f5a14613818bc8a9c81bddf86eab29c312a147de9a6a21be3e1bbfd585d23496acd91df9e13ee9e31e82e8e0f3472fbb313b6501430afe98accf9726612256ba52dc415b0c01f3e16ad2e9969ea4ff56a874b6d1a212b71d73ed8eb0290a39f1b776bd1fb1c18a1d7b03363932a10590406630fdff9983ad79acf3cfe9c33d6f9fb087174ccbeb9e2b333c65aff7072ff39bcb8a18da02696894a03ea009b951e1266faf7fecb0f61c6bc4caf6941e1d21300faf407b996ee959b7d958379bebcb3e2b5ed6c30d9e28e16266b23db1ffd0bf13276acfbc553232323b9fa599a04108c5455a469809e1859851ad9942ad584929866d9f506c8b222c286034889456f805e9daa261774cbb652a4e198821b1a8102fd7ece03bf2f8f27a22619359605eea4cce157861577e18df8ea134760417608bfad1f05f531d92316681e291dd7b3facd231e4f9687cff4abd15bddae82498e172e721587856431ef99af47861de7c246ad1d1da08f86c98ac5059f3c9977ab58fb07dcdf21630316fa45ca66e017fb4a1a9928ac494096c0fa0bdb0a267ad215bc1e3cb8f5c2afedd77d104b3e996a200abf59a6ebbbefe56a816f138d19b1d1503d8166278bddfe5062087a6305803cecc538d99d5d6f206201c3721a1b8129c4bd4efa6757d2d38556e1e2e6ac40f4565376332b068e29caec4a2e3e3f5fdf20d7c8a6742eeb0e2d2346eb4207433428fe7705cc785edce7409d1d7956e0725d47da491bc3578f439dd213efe1cdd616b015a3b2c41660742fb435fce00baea54e79918e4ee9624b124ed0298c11c40f3aca652ae962da291a7a93ac1db3c94a664f558d9980477034f85e7d0aef9dccece53e0a4271a0d1d4242ef4782cf8ce20d1276299eaed6051fa0bd8b2a82a060fc6b245c6c661dc1e685c4390adb580f1c05b467c11b751fabfb837709287238a248d32ffd743be9fa323202fc0d16b8ca99f06937da895d0fec80fcec6b4158b0e4d5087da285c22a57ab902a3db9cc94a58f1671aa32756bfcd05a646a61db3fe240f6243caf5e78abc0f2d830d6a3201c2dc8bc56707681bb4ffaf4139fef390f7fdff3641cd9a3f345d6611f10ccc0e5685b309c84cc3d1cc59f5e57672b188f93ffc263fed0cd7ca837abaa76d565a2fffd5a772bc8a506d4452dcba2204c9ab9e0f7725b121a7e641a9760e38ff6bbcc8243ddc6bf18cb372b6721a44c1d19415a67a2b438a5732b9de0d1050d83959e5b7db687de9e39f677426138f8ff9e788b60a7315291c85ace3109b03e323cae8d3784cc79220621c35780fe3685336504c7595826a24fc12de045e0f7aa7e0f0df2c3ba9c518da40cd85dc0ee86f23f927643af25c9c4de7f6994a702c754b439aee614c15f42ce80588fc746fce11e1ad8ea7ec7eeee953045038e33b2281d05be8b91dbe302e92d57ffdc088702e80ee9277699a161769cb085f4299d136ef2f4692ab0c036d0787bf57e9ec615373c8c194f4b3a4f1dbe813bee7b85866d91c58870785e14c668fcc30001014a04507db104c23f66ec6395c3de1059528deafa7224454d107e6a2d4ae1006dc16af74b8ee1acc75de36cfb2f4ad0486b5e63549325cdc2e35813cc2d144af4d021eaf47912550c6bfc95bbd247dc7eb584e5d8ede64d7c38ff2d19dfa706a4977631e1b34cecb8734e8713f361c0f3bf5c7bd565f3ac6ec3c08952bd07ff3eb0797356f1995c6e839801918f92f4a4dfd023a60e3d2172b0218fb5dae59a775b83de3bfd4b2735a2a1097cae026f62af3a353b862e7db8e32eb74662ef228a3172158aec908a36893ecda285c6fbb843bf7dd4f97fd6cf32ff5e0431ffcc94dbc6f119c9c5699e2dafc2c03263b152fabfe9a6483c9f1281ea293dfcb0769c8400dd8918996b53c6af4e1a8bb206190796cbce988dc5ada4687cd7dff221a8be4582946959340266da1e6781c976f8e3d235509dcbb4da519acde4e8bbc59cbbfcce57ed6b8b4dc96adbf0d502e276574ec42ab1d0d9dff8afe1bcedb0a929383027984a8b7e0de2545f53b9000ce0dbb09d21421cb85023a98a480d80b9e25fdce5b2d89d6461aad96d5d71449c78924f932a93650191082b804971c65adf6e0d0876f5bb7d794902522d28ecfb963c1d13c81a892f6ef332b3e5098e9dd90ae163ebcfce5fb81c1bec4d00033cb4adcf591c797097d02d08f00617dc628dee55127be366851c79da587c0710d849a08fa3cb5d56579c969a0be9818e6a15a0607f68a21732eb7bfba46676acce7a125288313a64c24802a7018228499f4ed3014b1b9b8641fb6cc8cc40d0b96f1af4aadd031584bbc88e840e72bc103307a01c4d2a4dcea5ebd3e72c24ee815a6bc7c92674f4ae225633726cdf06ad2bf03e8ee196a85e8c27aa2a0e16fb93d25203531371dfb82367878aef1553e9c9de0e92ceac641abd215eb57f7729fa4d75fa4d79314e66975deb1d8c963b28607c3b25902d6fa77d7390d39f849420ed33a72868da13dd88fc4071cbcd1685c8528fc0f2b70a788985b3a513f51e7f110a4653f93839ab82fbf1f9ca3b58387edd1d520c0b5dd9ba31fcc44e92b40be17c200438b189064e8db968047d408cf094644e75a67357c7d9a56ade90fb2d2f1d5597b9f8c4f0dd75a7585de36a727bd485f11f14166314bf3e20c1d2b3fcb44959b6d88cad3f0318938a627d042dbc3147511d015333a30894e1e8b2f78c4b2a054db3d6898c2cec1c16aaeaab4bea2fd113b8ccf42b36e770b4e80602d273bb6787a0d34c3cf1dfda623a9d6168c713ba051795a0b23ea040561d87dd964f547965d23eb8c9aab2671457b1c3a156792a345a7b71b58a7948a853532f1df6dcf1f94469ebbcfdfb8f5f8e8236927a6dec83c549ac4377c265493a3396be1b487d435ca8dc71805a482a39d9beb85149892c6f9a2670d7e7e1ea842ee59120695529f4c7be63aea197fe35421e740dab7f8e79d6e97f3893ee0457e7123752f9eb89f1dcfc4d0918cb03db5999ae43dfc55b75655f3481924db5d5743b2294f4156538b13223b72e57a25ab9c67a34507e2fdcb002517d91d30e9afc45f57eee057453899aa93d924773ecf5c14a7c7807955b77d8dd6416ae40750b7ddf5ec80aa525634f80735e003d75c197aaa7c3676b90f131d9f6f2e89abb638be5b1fd6cc29b76ea7a94ff5a9baf8c7ac6b8294a2c6d5e5b0302f55edbce57cc59774ea1a675937d155089246f34cc3180ad20d0ce5b59124615246d110b201aff0cd52cd88077b6b91fcaceaef25a00e691360aab4baa373f49d051df94d53651557b7d021e7142c30bbb21f065b1c0ff0783f4a3171837336d2be8d0f99fad769c7b9f5a8ec4d2ec37f56bde0b1c34f73f4f81b0d2348d61933d9e13a7ad14af8f36a1223907e47652ebf263890830300070fb268f9887f31d95696419eff0a6add4096115299afed2ea786698c568e55bee1c766d0ec794c518ffebf36859c5ba65100de27ab3edf5ff2b2ad1f94f6cca43fccc1a5e969395567644fded51e5efc353c2d7cab7654b3185e7e80314d3bdddf448785dfd871cbefd50d3ed1ccae4f98e13821f5519cb50e12b8a830f73c4afd4d0b60230000000000000001e5ca018ac6d02ca5d4a0ae462086eebd6227713461814ba36907d53acd75f1fa94e1ab89cd49bb8eaf94a7ef6164082b8fe754b0bfb8ab7031ca8722f78d4affeef1ba0857e888a4f76593e185640c8aee39ff109181e258d051171ec8f87c45b075db74169ec85fada3e521c9256bb1fc29412e1509f25b66c093e8bba5d851f8611c8a72c13b460618506c62e27d6bec521504d623e23210533e58831f76f92d3271759688fd7fe51a40a2dad94c8fea6deec5d08d918a9b89f2a7029924de76b30739755570c3c7adc4ad205c35734fa520c5ecd1beac2c71a8bc871fe6301352b8e00dd285a5f997e0a2975df8d91d24cc22072422b918cb95db0dc48df5b2ac7f39c5ecd95d24c43c9fbdb32984d9ea4177876dfb632441fed0222c2858745fbcbf9be47d02db02c79c5d9089a0c9f660d295581ed250a4899655f537e90b36cdee8466de12c5e05d5503555cfa899bd3c56a7e53018ed055c86adb361b9e5bb5f579db55654b8347071e649abdcae6a2e9b87742ae1d5b4ca159a6f097eea10844f46816087ce0976226d0d469b7380a70e64f140127afc6ea5b152b4e08edb396b1ccbbd283336d860188a3cd7115afe6dd71ffe61aad20e8d0929ce635754871f19cf1c8f3e3c3b4d100c5faee2c0d15823d67bc69e21205cc2d6c4c7317cd6504739bc580fb8b72d339b4dc904ee763f7cbfed6c8f5532f25d0bc0a260a97093907327b4d732da2e02dfd0f38b42c59a6d097b6df4b6a35668fd314e0d16d33aa0c60a73656c8ce050c6aa0f2ad91d206d7c62ce0712e3280349e243e08369d77052f9005175b5eab5da2a088b8ff9a99231788d6ae5aa5881cdb07f85993b8b5ad4c6f2b947cd917944d7b2b0a306ceb634e465ca75b68bda91974d3170bbde89a9993eda1de365326e4eb73d5ae147c2a92d1a9375263b6fc9246ea5ac2b6981fe19cbd3e9f07a5e738d9db729f9250953218d14080f21ffd9c8637f79e2fd2382c8a9375162f41b5a4015da76698a9752473d7b3ea266bb44899c6eb106e601edebbd5de53d2dab5eb2f376cf4132c3bdef1aa71858143f564af8f07c7dc3152d5a35f5dd59bd02fc97315f8af1e2432987cddf8a21edd631164e77f4356eb128ffd3e518865762ee83be6e787ebd1583098a647006eac33b7ad6491560e94b340a5673fbb41c2947ae88f981c6bd2e7a79461634f4e451d2c492d358cd3fff0da8c377c4bae859eb3936d49ee30886666d8b8496ec008dba87ca205201907b5a131b140355b8444daa2c72437155ab30b1266f3221839687bef2137c73cc1caeebdc8c1cecb215af1da72734a36201fb37fa1a8e2756286f2f1bd993cf975362745f9034f6c8a47a2bc85588fa9d04448981be092714fe39bc36cd0ff27710816373ec00ae1840ff27de93e3d7756c440fe6dbebbe6bc5da603b9886a3b236229d6e97a09a536a80088250e3d687ca42ca1fab767539bf176a0896789104878a13a44a462d2b3b5d1e9f0343857a68db9a99f2d58cde5398efff2fc169db15482ec400df8ce138ab00d45471dc112c5e6f8313de6b8fd180f040be7100e414b54744e6c061b993725afafebe7ee2f6f067db5d8ebc595573c88b2be6066d5bad3837da2598b7eae7d2c9e22ff62202df7ee23c30d83d44ee23f67f73cac7ea89bc248b5dd62bb8680bd9e6be214566cd99a5ddb4d82d173c750d1f1fa00eb45e42ba44b61e5b8c2576c0fdb2f59f6a23a10196a5434068bcd5de651f31a3aea8f3a1394c9050d15a917ea8031291931e3ae92ad2f4bf2d49c36a874dc5733363bab1eb4ec40cc2c84840d2d0c4ba4f2bf3fa0199687befc79158075f4887d656943833789d68e58ba33813972e6a13f2dc02f20326704804e3e2d16cd66dffd4dbd968327e37a37f8235f389412c3e49aacae886a4a0a664c0c8aa26d975f8929130e928d63b34ce53d115d035a3a56918eadba60039cd35de91c4a0806ec19e22d8242326d6bb4abfdd7b06e424a73d3ca5da08f8a3096454c20ece255400f7453130364354f1db77387b7bcbe76fb6ad8db785cae6b22bd0f625d43fb0353b1e86e35eb9dd9bb2d5c8dec374210420e3040c5f7ce37ba04ce4293bc745d8b2b93fc71d5c47448abe79e4985aabe7d7c1090fb9239d15b5093355f8b2905aaa87ed706f277547516cf140f487becc4e353a7c5fd4cedf6942f52ccf5321a022181ab5ef2de3745277bce989482fe5007bc00640ef4b13db53e6b9d6d0b279f5918bc275750e9b8a2ab084a9d9daa001e8b769381627732ffb7223ae4ebb4dbd5c009a467c657d3d13b6e5f308318fb0c06a1c9659a720934f2cd80d88a53a49a6c5c7665db7467de875e80c72f6ba055b9720e1b6a0024c16a755eadf8b3a96918ff2cd13a13b976af3bea6de7a29e852edf4c8e44a5165b16fa1ec676cce6000a47f68de2202ac4c16f14f693ff53489a437f52e255b0813993bde86d65989f4570f6def21bc28a804547b38bcddcc7e9747b8b3660462af05eb4b2d30d8e063270ede0df13abdc6a554a446dc063422aafa7ebb3b17e92fc9948a3b5d69a86c078386569d9ed9b73c07cbaaaf03381e87ed668753dc5497a94bedc5543a5b50d3263138a7aa2c795e2db398e7b38664ba9974ea27df33a05f3568e270dda912590503396cc22bd9a5f70b1340a01d36e11d1b1d57abc83ad2dac4ce28e8b4374049311f86ffd28974f19dbe50ff48bf5064dfba0307adf452e67317af1e3071156d633027efc5ab4941a38b688f8c9a9970896b9d636d2f35b288d23c012724ee2514356bada435e279d8608f743345efe0fb802e5c4ac3fbca2b5a10eb86fe11a285c5efcabf36e1929951faf0ee1e31f79b8508ef7eeb1141cfe0011abda55e447fae0dc7c5b6e6ddccbb232d2ae5091bc78f196a59763e69a23e9ee34e0e113462b6b92907242558ce4779e5904b4b571e0f95c22ccda4711d22a90e837f5b612536dd4cc0e1c728fe879bf2d12b1272257b2c4c062ab2ce9762d1bd2a5f9c3d53237acc2c48af60f58ea983db5a0884eb70827723e75404ed02d1c397da40536e558139897ec69c0ad491ce5d3ec81f99391c4a55ae01bebef57e70f107805d5b9a9a3e8e48eaed7974140f81be96d1958ddda66c133133523812d96b8d72f4121542f7d3017e8235599ead52fc318e8145abb16aef5bc1217414d008b02e48b06d7a1b9380a25edad4c332f266bbb4962ebefe8974e5372cecb7bbc16ddd2fd11d7e70e56b2ba0bd0cc7c9555874561c6d86f47a404fd93b2a092cb9a4f98b3455322c19043121e9c731c099b397af065b188fe83388bf76b4dab9e08beb0b81ae99e2dffe7af7e694dd33ed53e8e2b4843d6e64076ea891b7756da6d218af40a7394503f2434d387986d5cdbc4ce6da8a448934758785398610e2ac1107bc7d127053d32450f265be980917d88bd5a40c37f8d799d4b14b698d2ff7cb6838593da2b3adf0d36ec254a809142fb85441a8018e6be1c7f159e040f4706d29c72c82141d94153ee53ddcf92cfb553592b678806111d6bbfddf7b91ba2d207cc8955db63ef8ddea96b139dde226f63691009ce9c30d05099c0290871120eeb8255ffa9a2892642796cefd2592593c3ffe03d6c76b570fd04b5efdbc1d0d5df60a0a8cc23883d792f00040d2489772674cccb9bd5fb2dea7a94ee2029daae0fcf1c679fd441f1d8bca71f3e5da17c1ef40aa5fdcc944255e81a209d605263a2c78d4d55af31c97c0fc9962667a27c1d6fff4735d9a5d4bf30b3d6aa920dd8bcc469fabd60020f4afd5023afc014582e5c1af4e0d001c16b24a46b4b9bf276637eb5ab0d8986c487c4acd6a35440ffaa8ea8a2cdbcb475730d8442868b14f47403cd1f5efe6faac55836b9764ec5244a164d1246e4eaf0ca6c0e53ec5ea147f7547037e9d781ce39de9cb10b7b50b566a7f2dcf2c482c00b8d752f220d75085da1a511e8229276d198c715eb8e44659f7171bb3b5448f942ea285bc26259ef2243295a9eb78851422ecc987d1b53c729af2a2ee40e57c6d2360c698303000749d0ca04d6fc08dde97ad23cdf22dd410240d64c94914714459f6deca33e2cbfc122476deaeedf9551f8bbc16f4d34cf69017b8382a902a2cc55d41dbab36271233ddfbd8e77ca42c1a247695bd77f7ad48db6d8a8d1ff43a59ca1877af0364064109093f54d6a45f86fff5f7c2c222d08304fb735906a1a42842e57e012800dfd4d0b60230000000000000001aa1400fd5d054449384995562badfef9e76ce2141f06b125876b8fbce4ecebeb12628d4feff1b547aae298c72c95b64c4ad5621919f2e6ad43ee8df95fdd9c6252809bed4f4d88870ba26a844b905be34e0bea957ca558bdedc1e002690a945037214b64acc049d36a458ea7fd8c3013ccebf8950f31972df6b0d592471aab617502a8cd7bae25d243a8782dae3462840736d7e11a2acadaed60e636e36a485f1d8eed54b6efcef548d99919eaa65e3923bb2f7099897be85e46551aa6b45a61a5b7ac59917f6a4642f19055194f65b98725bf451fb8d5712f569db48b0458966c979777e59baa5603de6416244c0b92b3c0968e2f78bc1e1f39545ce8c50071fe4efc2f8046956b0c911b12e1a961b04a248d401a0d06f8748284a2aff858e1b3713dea72ce43c3c0c18d1fed0b23365cd35014cdb068e9a6a42e1baefbb3c8ca8ae39d7df4ec00cec96be68f3df67be06bb5bb979259c6c60aea4635624c4399f3070eae3b601b22c182a4deba2c26e7651c889daa4bdf3bd5c937e8a1387c296aafe5b239b9128dc11d2834f8b7662c5bfc9d2c4d50bc8f9013425200a3547a6ba25fb6cc504f6566eb48ec488f48828a3dc291249987c3e163335f912cbd7c97cf0d09d6a18b335094e35c1274de251875aeb09029fd289af6b09126a070ce0d08eaf3b9d1a030176c631384a9e6e446e59ada4f3f326227263b208bc098892acf82df9c3271f600877e4754cc0efb520393bb63c78c88c0605f51e250b1cf26bc81590dbb4a181563ecb28fb73138c83bb771d686e0e3d53c7a2b31b9a9568b9c95444a829f110eb16a68cef132e1dbee8a0ae2f59699162e87178af7fc16084f0abdca3ba03585b3c1245b5caa4e531769b835a64606f91844e5e488421e6f6854901dbfddd7915aacd9f7b1231293ca6d50dacfb71a3407f46dca85bd844b6afdd6926933051631a633214deae160bbe34a2c36c1c141180e43bc79240144cd318d438a8169d4b9592d96abe42c1ecd46d48fe5d03d6ffb6dd8a7b516eb182cc19e731b59ec25bf6fd99dda42837d2416bbda67671b68835ed4143c8aafb7a733b4bac5a2b8482888f75853c16037841ef7056b5e5f57e07ea96695120b5daa3bc9fa32b604170565f4ad8cf429da2d244ff13ec2cb6fa0a671edeb4a9570a1193636f77786ea0e08ae0f17622a06ff5ba8d2141734f0e2b0ee87457b9fb566c46eba778cb5eb6744d310d5edda2dbd1a4cbca13ee74f48f23fabf11d1cae0c782e9c4c1f6a1f3fb7feb3869bae18fab39515a334ee1722d188eafa55caf371c6b4d510d6ea0d3cd0946c445849a8c8d2ba7f5a0d0d42cbe3aa87ad768537d2a5672bf5bef1e295fbc19427edd8d8b44f394eb7aed9f71f3713e2afb5276d06a4862ed9c5f852f22f6e113ffddf0b00de0bb3c511bad61783a04a6f89e388fe6f7a58d7fbf4173a5d1409dc5eb32152d5428013b6d359e4318dc0cddf2e0c1281f81d06fda77db9df13664a1d83c14b514b661e898bb78d163df352ca68258aa752efe0678d1d34f47919b22033b1c99825462fa469149baa825d4006cb253e95873a7898fa83117aaa0efca0d29a5cf23abc9c69515c806c2d0980d39670d705fa6324fd4ab3889b93b7708aae372b7d597bb3d4ae70da3504081c65da35b2ac1a6868c1ca1e312b097b898656dc2f8772a917cccdf475890eec51410d2a5c9a804bd272f9f59fba2a25f827c6e1a07275a34781199c3f5985de8d4c232234dbdb314c7d49e2f90c11db975ea98170a6bfb272c5126e4657e50a9036f122a12272b294f4551761056122977eadc686c75e01af84c8226d5c6904e9959875f4fb96a33e3b491ab829f4758da52af4fc03cb322847b913fd57a6456b6d5b4e94b71e63f8c2fcca78dd444a5f919108a7a6ff228d4a00e3d8e642ce35a85d1046ccbc9d66bbf8e17c0ef0531158fd722c5c000af86244f6242ed061d6fb046c6a20c22464484353e926c9438aef1480afbdc4c02bcee4c1f73331c81204932ccd8442d1c44e7b1852ac41f65778694c1bde462ddb87c847e81df08c637804bafe414db96f6b3d66ede9b1cb1dc6b050b8604435c37c7caefa677697a2e9a47ee783183052c9d94117d6c204f4c618bd5faf42745359e49dc997692d23abfcb7d8ebb79b71c28103566e77bbc6db443c2a674c65c8db0b5f8e4349e9d02301a4f51747e2dd5929fe4f4eb0789c365be1051568828c2d0bedcccefe50c0347fea26a27cc86fd4bab37f54008fe5265e906e9d4d5645193e3862f5b1509ecd0bf146a121cbdf0f7cf1471693fe21deaff40b26d15de9be1d387aec2e936cd039cff701dd2e7d4a9ae104a3c7bd93bed543c4f0af9921f2d6edee1a05bb1272e3e8fb662a86f75c5a6530f01d0c602aed1dc8d1165b2d723cb80be5b2ee4f4e4bb4130d0db4e7781c0bd99e9cefad525a77c23fc9929d5d8c752b6e59c3a2b03c2b88917f69c8a04aac7aac949514881b0e8e025fbcae33d78140e408a6ba8eb5a4b2fea40ec38f8f32dec4ba7d2e19c878e87199d5b8db8d7af7f013ca40fc97685dc86ebe63a51613c6eb1621df99a6968bbabefdf15351846b6c1d79d5fa1933f45e9e4768a8c5463bc9e25472520120c6a500f6ef0e7ab151f30d0d2bd4a95925ea2b780d16f224f76d96d1ccf8965701d0bc8fe9c0f756d5fdb4ef07dabc69dccf527d1c9aa694e66a774372580d99d6625fcade07781e45e456a255c47ffdf37924e246627db977844086c6857b15e43e2a640ee3a34b2a15e537114f5331ed9bf96a291064b5ede514d40b1ac19bc4266986141408e1a67bf36b462bf320eb645c52dd19235478aecc89fb89fa61024dd2abaab0c1331c75e793ad701861ec137d47d5c7d50a41e3331ba19a1fbb68a52430fb63ab1390b5c84fb32e277b36253743ef8fcf7726a73781ac06d818156064e758e304e34a12a17edd3c28fe4fb7170948827f15af322bcf9d699b2981879380cfc632d0a8d7bf4838950d4c475681c5679c6f5fc07ff25e45e367fa08c68d9f23ba4a39dd7e40fb8ccde6cff83c00cb14f3087e4b8d7f11a117b4c3648aa0c7016198c8ef00985eb3a17aac5c80f3a032f711b8c4c2c9e9bb8128feb9c2702f1a37b9711bc3b9866e1291943f6a7adcce314338929a80bb1fce7cfc3ba69004ef3c9eca700923b81d74e96de2817f2c76595a3deb603ee7b7f0e6d2cf0dc68ff7a33584a9a13a8fa3d580731da3553417a36187c3a20caf7cecf7fd5f5b65e39207bd70b13b1139835b02d108ffc57ab50d26d4af580a71b3cfd8b0105d3d97a1bbd893803c576c266149badbc1b5f88fc7c106c72272d26e58ed8d08de2f969f3932969e8078bcd12a3f0af30041da278571073d80d7606a1a09e8f6dbe454114e84442379b09b30ec0246c63f1f66697ae76f1730f6e556b853bfc57810c539e14c6d2591df5d292bdcf291c53d9084e027a739957d57416157f507ae5d6493c0f9c5bf02b2358bfc0c50eb8d82561c2e8c4bc435bfbdcff44e960b3ec4aaa2796852ceae0c7b56cea0fed943b02e1810392af5917972bfbdbb3defe3aa3004ebc425536c705a4b6edbadf7df40374345d01a3aefc942cd8329f0d20e22863ab8cc977b93dfb2c1db137fead1cf5cca626bf22dbcb262acafe968e65b3cc80e9ffb1e679645723dc45fdbcd69851b66aaa28d6427de89e978ea20af57bec53833f161284dfd26c583018e7c42b3a9753f77d1735b456978b692944986f627892e71a5b08e13dd5764272d72ea0c5f6ebc4c815c75af7acb9167559678efa3463e07c3ca06c0d1fa59b016a5af59ac6e02d32aeb6a676feb3fd7feb9533fa67da24e50dc8c7cde3558f9585ad137497f380c908abe3bf9330e7fcc2fe8616463a2fe439d3730ba1e96b1857a0160ccda1db4e35f52b379448dbeeebb3ade791950ee32ebafa170a94ddde0787d8e4212f4f1fc50246bf45002bb3c5842fcba0dd19d7570a5cff7bdc480cd81bdb4d5d37fb483bed93c2d0856d0a18012e0c353d888308ed3ed06907b15a0c00000", "isElements": true, "txins":[{"txid":"4a48d6eae92ea5c6c2cd6eac7619edc6f9ebcce999dcec6669e8b1f54a81cce4", "vout":1, "address":"ert1qppexyx85s385srndchfa2tja76ju77ted4zey2vyvq698609saks5jpjma", "descriptor":"", "confidentialValueCommitment":"08014db26ca6fede7f381a16b0a1b52d56b703c8f96f1bd9ebd0de002034f63c28"}]}'],
    '{"success":false,\"failTxins\":[{\"txid\":\"4a48d6eae92ea5c6c2cd6eac7619edc6f9ebcce999dcec6669e8b1f54a81cce4\",\"vout\":1,\"reason\":\"Unmatch locking script.\"}]}',
  ),
];

const errorCase = [
  TestHelper.createBitcoinTestCase(
    'VerifySign HashType(P2WPKH)',
    VerifySign,
    ['{"tx":"020000000001019c53cb2a6118530aaa345b799aeb7e4e5055de41ac5b2dd2ce47419624c57b580000000000ffffffff0130ea052a010000001976a9143cadb10040e9e7002bbd9d0620f5f79c05603ffd88ac0247304402200aecb70a0dfff96a088c6cd60dc5905e8117f5e68e9009de0e45a87fe5f6bdc402204188555d295daaf309716ca2372bb9d9cc778105fe87de50f5a9ccc352acf314012103f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d600000000","isElements":false,"txins":[{"txid":"", "vout":0, "address":"", "amount":1000000, "descriptor":"wpkh(03f942716865bb9b62678d99aa34de4632249d066d99de2b5a2e542e54908450d6)"}]}'],
    '{\"error\":{\"code\":1,\"type\":\"illegal_argument\",\"message\":\"Txid size Invalid.\"}}',
  ),
];

TestHelper.doTest('VerifySign', testCase);
TestHelper.doTest('VerifySign ErrorCase', errorCase);
